{
    "version": "https://jsonfeed.org/version/1",
    "title": "好暖好温暖的博客",
    "subtitle": "一个电子信息系的大学生",
    "icon": "https://haoruanwn.github.io/assets/favicon.ico",
    "description": "记录学习与生活的点滴",
    "home_page_url": "https://haoruanwn.github.io",
    "items": [
        {
            "id": "https://haoruanwn.github.io/2025/08/24/%E8%B0%83%E8%AF%95USB%E6%91%84%E5%83%8F%E5%A4%B4/",
            "url": "https://haoruanwn.github.io/2025/08/24/%E8%B0%83%E8%AF%95USB%E6%91%84%E5%83%8F%E5%A4%B4/",
            "title": "调试USB摄像头",
            "date_published": "2025-08-24T12:21:57.000Z",
            "content_html": "<h1 id=\"usb摄像头带麦克风和扬声器调试\"><a class=\"anchor\" href=\"#usb摄像头带麦克风和扬声器调试\">#</a> USB摄像头（带麦克风和扬声器）调试</h1>\n<p>带麦克风咪头和扬声器的USB摄像头<br />\n<img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/20250824202654485.jpg\" alt=\"qq_pic_merged_1756038364912\" /></p>\n<h2 id=\"摄像头探测\"><a class=\"anchor\" href=\"#摄像头探测\">#</a> 摄像头探测</h2>\n<p>首先，需要确认摄像头设备是否被系统正确识别。</p>\n<ol>\n<li>\n<p>列出USB设备</p>\n<p>使用lsusb命令可以查看所有连接到系统的USB设备。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">hao@lckfb-taishanpi:~$</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> lsusb</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Bus</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 001</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 001:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ID</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1d6b:0002</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Linux</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Foundation</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2.0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> root</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hub</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Bus</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 002</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 001:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ID</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1d6b:0003</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Linux</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Foundation</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 3.0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> root</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hub</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Bus</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 003</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 001:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ID</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1d6b:0002</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Linux</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Foundation</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2.0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> root</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hub</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Bus</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 004</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 001:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ID</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1d6b:0001</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Linux</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Foundation</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1.1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> root</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hub</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Bus</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 004</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 002:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ID</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 349c:3307</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Generic</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> HD</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> video</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">  </span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Bus</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 005</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 001:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ID</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1d6b:0002</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Linux</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Foundation</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2.0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> root</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hub</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">Bus</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 006</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 001:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ID</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1d6b:0001</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Linux</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Foundation</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1.1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> root</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hub</span></span></code></pre>\n<p>其中<code>HD video</code>就是我们的USB摄像头。</p>\n</li>\n<li>\n<p>查看视频设备节点</p>\n<p>系统会为视频设备创建相应的设备文件。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">hao@lckfb-taishanpi:~$</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ls</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /dev/video</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">*</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">/dev/video0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  /dev/video1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  /dev/video2</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  /dev/video5</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  /dev/video-dec1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  /dev/video-dec2</span></span></code></pre>\n</li>\n<li>\n<p>使用v4l-utils工具</p>\n<p>v4l-utils是一个强大的视频设备调试工具集，可以提供更详细的设备信息。如果系统未安装，请先安装。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> apt-get</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> v4l-utils</span></span></code></pre>\n<p>使用<code>v4l2-ctl</code>列出所有视频设备及其关联的设备节点。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">hao@lckfb-taishanpi:~$</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> v4l2-ctl</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --list-devices</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">rockchip,rk3328-vpu-dec</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">platform:fdea0000.video-codec</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        /dev/video2</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        /dev/media1</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">rockchip,rk3568-vepu-enc</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">platform:fdee0000.video-codec</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        /dev/video5</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        /dev/media3</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">rockchip-rga</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">platform:rga</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        /dev/video0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">rkvdec2</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">platform:rkvdec2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        /dev/video1</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        /dev/media0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">HD</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> video</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  :</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> HD</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> video</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">   </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">usb-fd840000.usb-1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        /dev/video3</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        /dev/video4</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        /dev/media2</span></span></code></pre>\n<p>从输出中可以看到，名为<code>HD video</code>的USB摄像头关联了<code>/dev/video3</code>和<code>/dev/video4</code>两个设备节点。</p>\n</li>\n</ol>\n<h2 id=\"查看摄像头参数\"><a class=\"anchor\" href=\"#查看摄像头参数\">#</a> 查看摄像头参数</h2>\n<p>接下来，我们需要确定哪个设备节点是有效的，并查看其支持的视频格式、分辨率和帧率。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">hao@lckfb-taishanpi:~$</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> v4l2-ctl</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -d</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /dev/video4</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --list-formats-ext</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ioctl:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> VIDIOC_ENUM_FMT</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        Type:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Video</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Capture</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">hao@lckfb-taishanpi:~$</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> v4l2-ctl</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -d</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /dev/video3</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --list-formats-ext</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ioctl:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> VIDIOC_ENUM_FMT</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        Type:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Video</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Capture</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">0</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#998418;--shiki-dark:#B8A965\">:</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">MJPG</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Motion-JPEG, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">compressed</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                Size:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1280x720</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                        Interval:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0.067s</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">15.000 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">fps</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                        Interval:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0.100s</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">10.000 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">fps</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                Size:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 800x480</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                        Interval:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0.050s</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">20.000 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">fps</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                        Interval:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0.067s</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">15.000 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">fps</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                Size:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 640x480</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                        Interval:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0.040s</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">25.000 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">fps</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                        Interval:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0.067s</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">15.000 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">fps</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                Size:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 480x320</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                        Interval:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0.040s</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">25.000 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">fps</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                        Interval:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0.067s</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">15.000 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">fps</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                Size:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 480x854</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                        Interval:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0.040s</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">25.000 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">fps</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                        Interval:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Discrete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0.050s</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">20.000 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">fps</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>结果表明，<code>/dev/video4</code>不支持视频捕获格式，而<code>/dev/video3</code>支持<code>MJPG</code>格式，并列出了多种分辨率和帧率的组合。因此，我们应该使用<code>/dev/video3</code>作为视频输入设备。</p>\n<h2 id=\"使用摄像头\"><a class=\"anchor\" href=\"#使用摄像头\">#</a> 使用摄像头</h2>\n<h3 id=\"拍照\"><a class=\"anchor\" href=\"#拍照\">#</a> 拍照</h3>\n<p>使用<code>ffmpeg</code>从摄像头捕获一帧图像并保存为图片。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ffmpeg</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -f</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> v4l2</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -i</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /dev/video3</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -ss</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0.5</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -vframes</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -update</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">您的文件名.jp</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">g</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span></span></code></pre>\n<h3 id=\"录制视频无声\"><a class=\"anchor\" href=\"#录制视频无声\">#</a> 录制视频（无声）</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ffmpeg</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -f</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> v4l2</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -input_format</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mjpeg</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -s</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1280x720</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -r</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 15</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -i</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /dev/video3</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -c:v</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> copy</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> output.mkv</span></span></code></pre>\n<p>在终端里按<code>Ctrl + C</code>停止录制。</p>\n<p><strong>参数说明:</strong></p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>-f v4l2</code></td>\n<td>强制使用<code>v4l2</code>驱动。</td>\n</tr>\n<tr>\n<td><code>-input_format mjpeg</code></td>\n<td>指定输入流是摄像头支持的<code>mjpeg</code>格式。</td>\n</tr>\n<tr>\n<td><code>-s 1280x720</code></td>\n<td>设置视频分辨率。</td>\n</tr>\n<tr>\n<td><code>-r 15</code></td>\n<td>设置视频帧率。</td>\n</tr>\n<tr>\n<td><code>-i /dev/video3</code></td>\n<td>指定输入设备。</td>\n</tr>\n<tr>\n<td><code>-c:v copy</code></td>\n<td>直接复制视频流，不进行重新编码，以降低CPU消耗。</td>\n</tr>\n<tr>\n<td><code>output.mkv</code></td>\n<td>输出的视频文件名。</td>\n</tr>\n</tbody>\n</table>\n<p><strong>注意</strong>: 分辨率和帧率需要选择摄像头支持的组合。根据探测结果，<code>1280x720</code>分辨率下支持<code>15.000 fps</code>。</p>\n<h2 id=\"音频设备探测\"><a class=\"anchor\" href=\"#音频设备探测\">#</a> 音频设备探测</h2>\n<p>使用<code>aplay</code>和<code>arecord</code>命令探测播放和录音设备。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">hao@lckfb-taishanpi:~$</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> aplay</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -l</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">****</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> List of PLAYBACK Hardware Devices </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">****</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">card</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> video</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">HD </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">video],</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> USB</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Audio</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">USB </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Audio]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  Subdevices:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1/1</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  Subdevice</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> #0: subdevice #0</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">card</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> RK809</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Analog </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">RK809],</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> fe410000.i2s-rk817-hifi</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> rk817-hifi-0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">fe410000.i2s-rk817-hifi </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">rk817-hifi-0]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  Subdevices:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0/1</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  Subdevice</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> #0: subdevice #0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">hao@lckfb-taishanpi:~$</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> arecord</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -l</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">****</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> List of CAPTURE Hardware Devices </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">****</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">card</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> video</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">HD </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">video],</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> USB</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Audio</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">USB </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Audio]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  Subdevices:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1/1</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  Subdevice</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> #0: subdevice #0</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">card</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> RK809</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Analog </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">RK809],</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> fe410000.i2s-rk817-hifi</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> rk817-hifi-0</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">fe410000.i2s-rk817-hifi </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">rk817-hifi-0]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  Subdevices:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0/1</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  Subdevice</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> #0: subdevice #0</span></span></code></pre>\n<p><strong>设备列表:</strong></p>\n<table>\n<thead>\n<tr>\n<th>设备名称</th>\n<th>类型</th>\n<th>声卡号 (Card)</th>\n<th>设备号 (Device)</th>\n<th>ALSA标识</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>HD video</strong></td>\n<td>播放 &amp; 录制</td>\n<td>0</td>\n<td>0</td>\n<td><code>hw:0,0</code></td>\n</tr>\n<tr>\n<td><strong>Analog RK809</strong></td>\n<td>播放 &amp; 录制</td>\n<td>1</td>\n<td>0</td>\n<td><code>hw:1,0</code></td>\n</tr>\n</tbody>\n</table>\n<p>我们的USB摄像头集成了麦克风和扬声器，被识别为声卡0。</p>\n<h2 id=\"使用音频设备\"><a class=\"anchor\" href=\"#使用音频设备\">#</a> 使用音频设备</h2>\n<h3 id=\"录制有声视频\"><a class=\"anchor\" href=\"#录制有声视频\">#</a> 录制有声视频</h3>\n<p>结合视频和音频输入，录制带有声音的视频。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ffmpeg</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -f</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> v4l2</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -input_format</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mjpeg</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -i</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /dev/video3</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -f</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> alsa</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -channels</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -i</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hw:0,0</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -c:v</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> copy</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -c:a</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> aac</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> video_with_audio.mp4</span></span></code></pre>\n<p><strong>新增音频参数说明:</strong></p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>-f alsa</code></td>\n<td>强制使用<code>alsa</code>作为音频驱动。</td>\n</tr>\n<tr>\n<td><code>-channels 1</code></td>\n<td>设置音频通道为单声道。某些设备可能不支持双声道录制。</td>\n</tr>\n<tr>\n<td><code>-i hw:0,0</code></td>\n<td>指定音频输入设备（声卡0，设备0）。</td>\n</tr>\n<tr>\n<td><code>-c:a aac</code></td>\n<td>指定音频编码器为<code>aac</code>。</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"播放音频\"><a class=\"anchor\" href=\"#播放音频\">#</a> 播放音频</h3>\n<ul>\n<li>\n<p><strong>使用<code>aplay</code>播放<code>.wav</code>格式文件</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">aplay</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -D</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hw:0,0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> test_sound.wav</span></span></code></pre>\n<p><code>-D hw:0,0</code>明确指定使用声卡0，设备0进行播放。</p>\n</li>\n<li>\n<p>使用ffplay播放多种格式音频</p>\n<p>ffplay可以播放mp3等多种格式，并且能自动选择默认声卡。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ffplay</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> music.mp3</span></span></code></pre>\n</li>\n</ul>\n",
            "tags": [
                "单板计算机/Linux开发板",
                "音视频"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/08/22/%E4%BD%BF%E7%94%A8Docker%E5%AE%89%E8%A3%85%E5%B9%B6%E8%BF%90%E8%A1%8CVivado%E5%BC%80%E5%8F%91%E5%A5%97%E4%BB%B6/",
            "url": "https://haoruanwn.github.io/2025/08/22/%E4%BD%BF%E7%94%A8Docker%E5%AE%89%E8%A3%85%E5%B9%B6%E8%BF%90%E8%A1%8CVivado%E5%BC%80%E5%8F%91%E5%A5%97%E4%BB%B6/",
            "title": "使用Docker安装并运行Vivado开发套件",
            "date_published": "2025-08-21T16:06:40.000Z",
            "content_html": "<h1 id=\"使用-docker-安装并运行-vivado-开发套件\"><a class=\"anchor\" href=\"#使用-docker-安装并运行-vivado-开发套件\">#</a> 使用 Docker 安装并运行 Vivado 开发套件</h1>\n<p>本文档旨在记录如何通过 Docker 来安装和运行 Xilinx Vivado 开发套件，以实现开发环境的隔离与快速部署。</p>\n<h2 id=\"1-修复语言环境问题的-dockerfile\"><a class=\"anchor\" href=\"#1-修复语言环境问题的-dockerfile\">#</a> 1. 修复语言环境问题的 Dockerfile</h2>\n<p>基础镜像 <code>gusanagy/xilinx-vivado:2024.1-x11</code> 存在语言环境（locale）配置问题，可能导致部分 GUI 工具无法正常启动。通过以下 <code>Dockerfile</code> 可以修复此问题。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-dockerfile\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> gusanagy/xilinx-vivado:2024.1-x11</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 切换到 root 用户以获得安装权限</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">USER</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> root</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 修复命令，来安装并生成语言环境</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">RUN</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> apt-get update &#x26;&#x26; \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    apt-get install -y locales &#x26;&#x26; \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    sed -i -e </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">'s/# en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> /etc/locale.gen &#x26;&#x26; \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    dpkg-reconfigure --frontend=noninteractive locales</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 将修复好的语言环境设置为系统默认</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">ENV</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> LANG en_US.UTF-8</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">ENV</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> LANGUAGE en_US:en</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">ENV</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> LC_ALL en_US.UTF-8</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 切换回镜像默认的非 root 用户</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">USER</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> vivadouser</span></span></code></pre>\n<h2 id=\"2-配置-docker-composeyml\"><a class=\"anchor\" href=\"#2-配置-docker-composeyml\">#</a> 2. 配置 docker-compose.yml</h2>\n<p>为了简化容器的启动和管理，我们使用 <code>docker-compose.yml</code> 文件来定义服务。该配置包含了 GUI 转发、工作目录挂载以及可选的硬件设备映射。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-yaml\"><span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">services</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">  vivado</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    build</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> .</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    image</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> vivado-fixed:2024.1</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    container_name</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> vivado</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    stdin_open</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> true</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    tty</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> true</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    environment</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">      -</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> DISPLAY=$&#123;DISPLAY&#125;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">      # - XAUTHORITY=$&#123;XAUTHORITY&#125;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    volumes</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">      -</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /tmp/.X11-unix:/tmp/.X11-unix</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">      # - ~/.Xauthority:/home/vivadouser/.Xauthority:ro</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">      -</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> .:/home/vivadouser/workspace</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    working_dir</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /home/vivadouser/workspace</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # (可选) 挂载JTAG等硬件设备</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # devices:</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    #   - \"/dev/xilinx_jtag:/dev/xilinx_jtag\"</span></span></code></pre>\n<h2 id=\"3-构建镜像并启动容器\"><a class=\"anchor\" href=\"#3-构建镜像并启动容器\">#</a> 3. 构建镜像并启动容器</h2>\n<p>将上述两个文件放置在同一目录下，然后执行以下命令来构建镜像并以守护进程模式（<code>-d</code>）启动容器。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compose</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> up</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -d</span></span></code></pre>\n<p>对于旧版本的 Docker，可能需要使用 <code>docker-compose</code>：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">docker-compose</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> up</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -d</span></span></code></pre>\n<h2 id=\"4-启动-vivado-图形化界面\"><a class=\"anchor\" href=\"#4-启动-vivado-图形化界面\">#</a> 4. 启动 Vivado 图形化界面</h2>\n<p>容器成功运行后，按照以下步骤进入容器并启动 Vivado。</p>\n<h3 id=\"41-进入容器内部\"><a class=\"anchor\" href=\"#41-进入容器内部\">#</a> 4.1 进入容器内部</h3>\n<p>执行 <code>docker exec</code> 命令进入容器的交互式终端。推荐使用 <code>-u vivadouser</code> 参数以非 root 用户身份登录，以避免潜在的权限问题。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> exec</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -it</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -u</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> vivadouser</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> vivado</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bash</span></span></code></pre>\n<h3 id=\"42-初始化环境变量\"><a class=\"anchor\" href=\"#42-初始化环境变量\">#</a> 4.2 初始化环境变量</h3>\n<p>在容器的 shell 中，首先需要 source Vivado 的设置脚本来配置必要的环境变量。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">source</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /home/vivadouser/Vivado/2024.1/settings64.sh</span></span></code></pre>\n<h3 id=\"43-启动图形化界面\"><a class=\"anchor\" href=\"#43-启动图形化界面\">#</a> 4.3 启动图形化界面</h3>\n<p>最后，执行 <code>vivado</code> 命令启动 Vivado 的图形化界面。使用 <code>&amp;</code> 将其置于后台运行，以免阻塞当前终端。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">vivado</span><span style=\"color:#999999;--shiki-dark:#666666\">&#x26;</span></span></code></pre>\n<h2 id=\"5-注意事项\"><a class=\"anchor\" href=\"#5-注意事项\">#</a> 5. 注意事项</h2>\n<ul>\n<li><strong>镜像体积</strong>：基础镜像 <code>gusanagy/xilinx-vivado</code> 体积接近 25GB，请确保本地磁盘空间充足且网络条件良好，以便顺利拉取。</li>\n<li><strong>X11 转发</strong>：在 Linux 主机上，<code>docker-compose.yml</code> 中的 <code>DISPLAY</code> 和 <code>/tmp/.X11-unix</code> 挂载通常足以实现 GUI 转发。在 macOS 或 Windows (WSLg) 上，可能需要额外的 X Server 配置。</li>\n</ul>\n",
            "tags": [
                "FPGA/ZYNQ",
                "Vivado"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/08/20/Programing/Rust/Rust%E4%B8%AD%E7%9A%84Enum/",
            "url": "https://haoruanwn.github.io/2025/08/20/Programing/Rust/Rust%E4%B8%AD%E7%9A%84Enum/",
            "title": "Rust中的Enum",
            "date_published": "2025-08-20T15:08:51.000Z",
            "content_html": "<h1 id=\"rust-中的枚举-enum\"><a class=\"anchor\" href=\"#rust-中的枚举-enum\">#</a> Rust 中的枚举 (Enum)</h1>\n<p>枚举（Enumeration）是一种允许我们列举所有可能的值来定义一个类型的方式。</p>\n<h2 id=\"定义枚举\"><a class=\"anchor\" href=\"#定义枚举\">#</a> 定义枚举</h2>\n<p>我们可以使用 <code>enum</code> 关键字来定义一个枚举类型，它的每个成员（变体）都可以代表一种可能的值。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">enum</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> IpAddrKind</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    V4</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    V6</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h3 id=\"将数据附加到枚举变体\"><a class=\"anchor\" href=\"#将数据附加到枚举变体\">#</a> 将数据附加到枚举变体</h3>\n<p>Rust 的枚举一个强大的功能是，每个变体都可以关联不同类型和数量的数据。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">enum</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> IpAddrKind</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    V4</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">String</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    V6</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">String</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> home</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> IpAddrKind</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">V4</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">String</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">127.0.0.1</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> loopback</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> IpAddrKind</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">V6</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">String</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">::1</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<p>我们还可以为每个变体定义不同类型和结构的关联数据。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">enum</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Message</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    Quit</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    Move</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> i32</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> i32</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 关联一个匿名结构体</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    Write</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">String</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">           // 关联一个 String</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    ChangeColor</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">u8</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u8</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u8</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 关联一个三元组</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h2 id=\"为枚举实现方法\"><a class=\"anchor\" href=\"#为枚举实现方法\">#</a> 为枚举实现方法</h2>\n<p>与结构体类似，我们也可以使用 <code>impl</code> 关键字为枚举定义方法。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">impl</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Message</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> process</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        match</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">            Message</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Quit</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> println!</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Quit message received</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">            Message</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Move</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a13865;--shiki-dark:#d9739f\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a13865;--shiki-dark:#d9739f\">&#125;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> println!</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Move message received: x=</span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">, y=</span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">            Message</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Write</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">text</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> println!</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Write message received: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> text</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">            Message</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">ChangeColor</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">r</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> g</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> b</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> println!</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">ChangeColor message received: r=</span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">, g=</span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">, b=</span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> r</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> g</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> b</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h2 id=\"option-枚举\"><a class=\"anchor\" href=\"#option-枚举\">#</a> <code>Option</code> 枚举</h2>\n<p><code>Option</code> 是一个由标准库定义的非常重要的枚举。它用于处理一个值可能存在或不存在的情况，有效地替代了其他语言中普遍存在的 <code>null</code>。</p>\n<p><code>Option&lt;T&gt;</code> 的定义如下：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">enum</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Option</span><span style=\"color:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">T</span><span style=\"color:#999999;--shiki-dark:#666666\">></span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    Some</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">T</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 表示存在一个 T 类型的值</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    None</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 表示不存在值</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<p>使用 <code>Option</code> 可以让编译器强制我们处理值不存在的情况，从而提高代码的健壮性。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> i8</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 4</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Option</span><span style=\"color:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">i8</span><span style=\"color:#999999;--shiki-dark:#666666\">></span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Some</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 为了处理 y 可能为 None 的情况，不能直接将 x 和 y 相加</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 必须使用 match 表达式来处理</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">match</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    Some</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">val</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> println!</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">x + y = </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> +</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> val</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    None</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> println!</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">y is None</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h2 id=\"match-控制流运算符\"><a class=\"anchor\" href=\"#match-控制流运算符\">#</a> <code>match</code> 控制流运算符</h2>\n<p><code>match</code> 是 Rust 中一个强大的控制流运算符，它允许我们将一个值与一系列模式进行比较，并根据匹配的模式执行相应的代码。<code>match</code> 常常与枚举一起使用，以确保我们处理了所有可能的变体。</p>\n<p><code>match</code> 的匹配是穷尽的，这意味着我们必须为所有可能的值提供一个分支。这在处理枚举时特别有用，因为编译器会检查是否遗漏了任何变体。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">enum</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Coin</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    Penny</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    Nickel</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    Dime</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">    Quarter</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> value_in_cents</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">coin</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Coin</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u8</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    match</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> coin</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">        Coin</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Penny</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">        Coin</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Nickel</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 5</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">        Coin</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Dime</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">        Coin</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Quarter</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 25</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n",
            "tags": [
                "Programing",
                "Rust"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/08/20/Programing/Rust/Rust%E4%B8%AD%E7%9A%84Struct/",
            "url": "https://haoruanwn.github.io/2025/08/20/Programing/Rust/Rust%E4%B8%AD%E7%9A%84Struct/",
            "title": "Rust中的Struct",
            "date_published": "2025-08-20T15:08:30.000Z",
            "content_html": "<h1 id=\"rust-中的结构体-struct\"><a class=\"anchor\" href=\"#rust-中的结构体-struct\">#</a> Rust 中的结构体 (Struct)</h1>\n<p>结构体（Struct）是一种自定义数据类型，允许你将多个相关的值组合在一起，并为每个值命名。</p>\n<h2 id=\"定义与实例化\"><a class=\"anchor\" href=\"#定义与实例化\">#</a> 定义与实例化</h2>\n<p>使用 <code>struct</code> 关键字来定义一个结构体，并在花括号中为所有字段指定名称和类型。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 定义一个结构体</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">struct</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> User</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    name</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> String</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    age</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u8</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    email</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> String</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 创建结构体实例</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> user1</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> User</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    name</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> String</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Alice</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    age</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 30</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    email</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> String</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">alice@example.com</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h3 id=\"结构体更新语法\"><a class=\"anchor\" href=\"#结构体更新语法\">#</a> 结构体更新语法</h3>\n<p>当你想要基于另一个结构体实例来创建一个新实例，并且只更改其中少量字段时，可以使用 <code>..</code> 语法。这会使用未显式设置的字段的旧实例中的值。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> user2</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> User</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    email</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> String</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">hello@gmail.com</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    ..</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">user1</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // user1 的 name 和 age 字段会被用于 user2</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h2 id=\"元组结构体-tuple-structs\"><a class=\"anchor\" href=\"#元组结构体-tuple-structs\">#</a> 元组结构体 (Tuple Structs)</h2>\n<p>元组结构体是一种类似于元组的结构体，其字段没有名称，只有类型。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">struct</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> UserTuple</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">String</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u8</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> String</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">struct</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> UserTuple2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">String</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u8</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> String</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> user3</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> UserTuple</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">String</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Bob</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 25</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> String</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">bob@example.com</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<p><strong>注意</strong>：即使两个元组结构体具有完全相同的字段类型，它们也是不同的类型。例如，<code>UserTuple</code> 和 <code>UserTuple2</code> 是不可互换的。</p>\n<h2 id=\"使用-derive-trait-增加功能\"><a class=\"anchor\" href=\"#使用-derive-trait-增加功能\">#</a> 使用 <code>derive</code> trait 增加功能</h2>\n<p>我们可以通过 <code>#[derive]</code> 注解为结构体自动实现某些 trait。例如，<code>Debug</code> trait 允许我们使用 <code>&#123;:?&#125;</code> 或 <code>&#123;:#?&#125;</code> 格式化字符串来打印结构体实例，这对于调试非常有用。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">derive</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Debug</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">struct</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Rectangle</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    width</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u32</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    height</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u32</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> rect1</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Rectangle</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    width</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 30</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    height</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 50</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 使用 Debug trait 进行打印</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">println!</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:#?</span><span style=\"color:#999999;--shiki-dark:#666666\">&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> rect1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h2 id=\"结构体方法\"><a class=\"anchor\" href=\"#结构体方法\">#</a> 结构体方法</h2>\n<p>方法与函数类似，但它们在结构体（或枚举、trait对象）的上下文中定义，并且它们的第一个参数总是 <code>self</code>，代表调用该方法的结构体实例。</p>\n<h3 id=\"定义方法\"><a class=\"anchor\" href=\"#定义方法\">#</a> 定义方法</h3>\n<p>方法在 <code>impl</code> (implementation) 块中定义。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">impl</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Rectangle</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 方法的第一个参数永远是 self</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 计算面积，该方法借用了 Rectangle 实例的不可变引用</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> area</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u32</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">width </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">height</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 判断一个矩形能否容纳另一个矩形</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> can_hold</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">self</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> other</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Rectangle</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> bool</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">width </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> other</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">width </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;&#x26;</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">height </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">=</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> other</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">height</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 可变方法，借用了实例的可变引用，可以修改实例的字段</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> set_width</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;mut</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> self</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> width</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u32</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">        self</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">width </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> width</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th><code>self</code> 类型</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>&amp;self</code></td>\n<td>对实例的不可变借用，用于只读操作。</td>\n</tr>\n<tr>\n<td><code>&amp;mut self</code></td>\n<td>对实例的可变借用，用于修改实例的状态。</td>\n</tr>\n<tr>\n<td><code>self</code></td>\n<td>获取实例的所有权，将其移出调用者。</td>\n</tr>\n</tbody>\n</table>\n<p>调用可变方法：</p>\n<p>可变方法必须由一个可变的结构体实例来调用。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> mut</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> rect3</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Rectangle</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> width</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> height</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 20</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">rect3</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">set_width</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">15</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">println!</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Rectangle 3 的宽度是 </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> rect3</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">width</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h3 id=\"关联函数-associated-functions\"><a class=\"anchor\" href=\"#关联函数-associated-functions\">#</a> 关联函数 (Associated Functions)</h3>\n<p><code>impl</code> 块中也可以定义不以 <code>self</code> 作为第一个参数的函数，这被称为关联函数。它们通常用作构造函数。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">impl</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Rectangle</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 这是一个关联函数，因为它没有 self 参数</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // Self 是当前 impl 块中类型的别名，即 Rectangle</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> square</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">size</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u32</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> Self</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">        Self</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">            width</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> size</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">            height</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> size</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<p>关联函数使用 <code>::</code> 语法调用，而不是 <code>.</code> 语法。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 调用关联函数</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> rect2</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> Rectangle</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">square</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">20</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n",
            "tags": [
                "Programing",
                "Rust"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/08/20/Programing/Rust/Rust%E4%B8%AD%E7%9A%84Slice/",
            "url": "https://haoruanwn.github.io/2025/08/20/Programing/Rust/Rust%E4%B8%AD%E7%9A%84Slice/",
            "title": "Rust中的Slice",
            "date_published": "2025-08-20T15:07:41.000Z",
            "content_html": "<h1 id=\"rust-中的字符串切片-string-slice\"><a class=\"anchor\" href=\"#rust-中的字符串切片-string-slice\">#</a> Rust 中的字符串切片 (String Slice)</h1>\n<p>字符串切片（String Slice）是对 <code>String</code> 中一部分的引用。它允许你在不获取整个 <code>String</code> 所有权的情况下，引用其中的一部分连续数据。</p>\n<h2 id=\"创建切片\"><a class=\"anchor\" href=\"#创建切片\">#</a> 创建切片</h2>\n<p>你可以使用方括号和一个范围 <code>[start..end]</code> 来创建一个字符串切片。</p>\n<ul>\n<li><code>start</code>: 范围的起始索引，包含在切片中。</li>\n<li><code>end</code>: 范围的结束索引，<strong>不</strong>包含在切片中。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> s</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> String</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">hello world</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// \"hello\" 的切片，索引从 0 到 4</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> hello</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">s</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">..</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">5</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// \"world\" 的切片，索引从 6 到 10</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> world</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">s</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">6</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">..</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">11</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span></code></pre>\n<p>范围语法有一些方便的简写：</p>\n<table>\n<thead>\n<tr>\n<th>语法</th>\n<th>描述</th>\n<th>示例 (基于 <code>let s = String::from(&quot;hello&quot;);</code>)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>&amp;s[..end]</code></td>\n<td>从开头到索引 <code>end</code> (不含)</td>\n<td><code>let slice = &amp;s[..2];</code> // &quot;he&quot;</td>\n</tr>\n<tr>\n<td><code>&amp;s[start..]</code></td>\n<td>从索引 <code>start</code> 到结尾</td>\n<td><code>let slice = &amp;s[3..];</code> // &quot;lo&quot;</td>\n</tr>\n<tr>\n<td><code>&amp;s[..]</code></td>\n<td>整个字符串的切片</td>\n<td><code>let slice = &amp;s[..];</code> // &quot;hello&quot;</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"切片的本质\"><a class=\"anchor\" href=\"#切片的本质\">#</a> 切片的本质</h2>\n<p>切片本质上是一种特殊类型的引用，它是一个“胖指针”（fat pointer）或“宽指针”（wide pointer）。它内部存储了两部分信息：</p>\n<ol>\n<li>指向数据起始位置的指针。</li>\n<li>切片的长度。</li>\n</ol>\n<h2 id=\"将切片作为函数参数\"><a class=\"anchor\" href=\"#将切片作为函数参数\">#</a> 将切片作为函数参数</h2>\n<p>将字符串切片 <code>&amp;str</code> 作为函数参数，可以使函数更具通用性和灵活性。这样的函数既可以接收 <code>String</code> 的引用，也可以接收字符串字面量（它本身就是切片类型）。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 这个函数可以接收 String 类型 (例如 &#x26;s) 和 &#x26;str 类型 (例如 \"hello world\")</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> first_word</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">s</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">str</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">str</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> bytes</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> s</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">as_bytes</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    for</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">i</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">item</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> bytes</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">iter</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">enumerate</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> item</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> ==</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> b</span><span style=\"color:#999999;--shiki-dark:#666666\">'</span><span style=\"color:#999999;--shiki-dark:#666666\"> '</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">s</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">[</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">..</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">i</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 返回直到第一个空格的切片</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    &#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">s</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">..</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 如果没有空格，返回整个字符串的切片</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<p><strong>调用示例</strong>：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_string</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> String</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">from</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">hello world</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// first_word 对 &#x26;String 同样有效</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> word</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> first_word</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">my_string</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">println!</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">第一个单词是: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> word</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_string_literal</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">hello world</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// first_word 对字符串字面量也有效</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> word</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> first_word</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">my_string_literal</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">println!</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">第一个单词是: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> word</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n",
            "tags": [
                "Programing",
                "Rust"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/08/03/%E4%BD%BF%E7%94%A8pyocd%E8%B0%83%E7%94%A8FLM%E6%A0%BC%E5%BC%8F%E7%9A%84%E5%A4%96%E9%83%A8%E4%B8%8B%E8%BD%BD%E7%AE%97%E6%B3%95/",
            "url": "https://haoruanwn.github.io/2025/08/03/%E4%BD%BF%E7%94%A8pyocd%E8%B0%83%E7%94%A8FLM%E6%A0%BC%E5%BC%8F%E7%9A%84%E5%A4%96%E9%83%A8%E4%B8%8B%E8%BD%BD%E7%AE%97%E6%B3%95/",
            "title": "使用pyocd调用FLM格式的外部下载算法",
            "date_published": "2025-08-03T14:08:05.000Z",
            "content_html": "<h1 id=\"pyocd-调用-flm-格式的外部下载算法\"><a class=\"anchor\" href=\"#pyocd-调用-flm-格式的外部下载算法\">#</a> pyocd 调用 FLM 格式的外部下载算法</h1>\n<p>记录如何通过 <code>pyocd</code> 调用 Keil 使用的 <code>.FLM</code> 格式外部下载算法，将程序烧录到 STM32H7 系列微控制器的 QSPI Flash 中。</p>\n<h3 id=\"项目背景\"><a class=\"anchor\" href=\"#项目背景\">#</a> 项目背景</h3>\n<table>\n<thead>\n<tr>\n<th>项目</th>\n<th>内容</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>开发板</strong></td>\n<td><a href=\"https://item.taobao.com/item.htm?id=838568127129&amp;pisk=gIi_MI2qJ8VFHG385oJFVo7BQuZfhp-yDtwxExINHlETliHZN-S4uF2fcWMJI58DSjgIMX4a6Sz4c-GztAS2IAJXcxH86oua_-hEGXbZ_mPqTnMoNPSZHmWi-bkRbc8g0iZgmodya3-rQAq0DXNEywfGvRy60GEYHlqda56wy3-rIv6aBLkp4mlDc0oAkihYWyCLIWeTH-F9dyezHoITkGQL9W2YDoFOWyBLn81ADSF9d9eYBNQADPUd9-yVBoExMyHLt-EYHjEvdvF3HDUHAJJ41A9WHUubK3YovWsADDwpi5M1Cg2tfR98aANBwdoCqPN-BWsv6ibG95e-2B7gFPGbJDkVUiPrB4c0efC9aPDxRXwsTBbQd4liVknJtiGjEDcQpbKf45HnU4ziXESzPlP_lcH61_NKfXigXf8AVjls7XaQ0EjYXl2Ssln9T1Zjpczozyf6TSurLcUIwBSIirgo3-G6fGEEzf08r2AfP73rEkszcgP5F8QX2kSbd7JBdZbcEQOznV0AZ0zTKJ5ydp1_vPe3d7JBdZb0WJ2e3p9C1kC..&amp;spm=tbpc.boughtlist.suborder_itemtitle.1.3c6a2e8dVW0dPQ&amp;sku_properties=-1%3A-1\">反客STM32H750XHB6</a></td>\n</tr>\n<tr>\n<td><strong>参考工程</strong></td>\n<td><a href=\"https://github.com/Peakors/STM32H750XBH6_Template\">Peakors/STM32H750XBH6_Template</a></td>\n</tr>\n<tr>\n<td><strong>下载算法</strong></td>\n<td><code>FK750M6_XBH6_V0.FLM</code> (由开发板资料提供)</td>\n</tr>\n<tr>\n<td><strong>测试环境</strong></td>\n<td>Fedora 42 (经验可跨平台通用)</td>\n</tr>\n</tbody>\n</table>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/20250803220535715.png\" alt=\"Snipaste_2025-08-03_22-05-27\" /></p>\n<h3 id=\"前置依赖\"><a class=\"anchor\" href=\"#前置依赖\">#</a> 前置依赖</h3>\n<p>确保已安装以下工具链：</p>\n<ul>\n<li><code>pyocd</code></li>\n<li><code>cmake</code></li>\n<li><code>ninja</code> 或 <code>make</code></li>\n<li><code>arm-none-eabi-gcc</code></li>\n</ul>\n<h3 id=\"编译流程\"><a class=\"anchor\" href=\"#编译流程\">#</a> 编译流程</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 生成 Ninja/Make 构建文件</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cmake</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -S</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> .</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -B</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -G</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Ninja</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 执行编译</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cmake</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --build</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> build/</span></span></code></pre>\n<h3 id=\"原理说明\"><a class=\"anchor\" href=\"#原理说明\">#</a> 原理说明</h3>\n<p>通过在项目根目录创建 <code>pyocd_user.py</code> 脚本，可以自定义 pyOCD 的连接行为。pyOCD 在启动时会自动检测并加载该文件。</p>\n<p>我们在脚本中定义一个 <code>will_connect</code> 函数，该函数会在 pyOCD 连接目标板之前被调用。通过这个函数，我们可以向 pyOCD 的内存地图中添加外部 Flash 的信息（如 QSPI Flash），并指定其使用的 <code>.FLM</code> 下载算法。</p>\n<p>这种机制使得 pyOCD 能够在不修改内置目标支持的情况下，扩展对外部存储器的烧录能力。</p>\n<p><strong>1. 目录结构</strong></p>\n<ul>\n<li>将下载算法文件 <code>FK750M6_XBH6_V0.FLM</code> 存放到项目下的 <code>.config</code> 文件夹中。</li>\n<li>在项目根目录创建 <code>pyocd_user.py</code> 文件。</li>\n</ul>\n<p><strong>2. <code>pyocd_user.py</code> 脚本</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-python\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># pyocd_user.py</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">from</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> pyocd</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">core</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">memory_map </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> FlashRegion</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">import</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> logging</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># --- 定义外部 QSPI Flash 的参数 ---</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">FLM_FILE</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">.config/FK750M6_XBH6_V0.FLM</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> # 存放下载算法的相对路径</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">QSPI_FLASH_START</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> 0x</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">90000000</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">QSPI_FLASH_SIZE</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 32</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1024</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1024</span></span>\n<span class=\"line\"><span style=\"color:#A65E2B;--shiki-dark:#C99076\">QSPI_FLASH_BLOCKSIZE</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> 0x</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1000</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">def</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> will_connect</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">board</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">    这是一个 pyOCD 代理函数，会在连接前被自动调用。</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">    </span></span>\n<span class=\"line\"><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">    \"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    target </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> board</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">target</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 定义外部 Flash 区域</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    external_flash </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> FlashRegion</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        name</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">qspi_flash</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        start</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">QSPI_FLASH_START</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        length</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">QSPI_FLASH_SIZE</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        blocksize</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">QSPI_FLASH_BLOCKSIZE</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        is_boot_memory</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">False</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        flm</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">FLM_FILE</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 将其添加到内存地图</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    target</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">memory_map</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">add_region</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">external_flash</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    logging</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">info</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">f</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"用户脚本：成功添加外部 QSPI Flash 区域 '</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">external_flash</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">name</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">'\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>具体定义参考<code>/home/hao/.local/lib/python3.13/site-packages/pyocd/core/memory_map.py</code>（pyocd安装路径）</p>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/20250803215751929.png\" alt=\"Snipaste_2025-08-03_21-27-37\" /></p>\n<h3 id=\"烧录指令\"><a class=\"anchor\" href=\"#烧录指令\">#</a> 烧录指令</h3>\n<p>使用以下指令将编译生成的 <code>.bin</code> 文件烧录到 QSPI Flash 的起始地址 <code>0x90000000</code>。</p>\n<ul>\n<li><code>--target stm32h750xx</code>：指定目标芯片型号。</li>\n<li><code>-O connect_mode=under-reset</code>：设置连接模式为复位下连接。</li>\n<li><code>./build/STM32H750XBH6_Template.bin@0x90000000</code>：指定固件路径和烧录地址。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">pyocd</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> flash</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --target</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> stm32h750xx</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -O</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connect_mode=under-reset</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ./build/STM32H750XBH6_Template.bin@0x90000000</span></span></code></pre>\n<h3 id=\"日志参考\"><a class=\"anchor\" href=\"#日志参考\">#</a> 日志参考</h3>\n<p><strong>1. 简洁版日志</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">❯</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pyocd</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> flash</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --target</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> stm32h750xx</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -O</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connect_mode=under-reset</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ./build/STM32H750XBH6_Template.bin@0x90000000</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000447</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Loading</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /home/hao/projects/stm32_projects/STM32H750XBH6/CMake/STM32H750XBH6_Template/build/STM32H750XBH6_Template.bin</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> at</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x90000000</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">load_cmd</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">==================================================</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> 100%</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0002722</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Erased</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 65536</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bytes</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">sector</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, programmed 65536 bytes </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">8</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pages</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, skipped 0 bytes </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pages</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> at 28.14 kB/s </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">loader</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span></code></pre>\n<p><strong>2. 详细版日志 (<code>-v</code> 参数)</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">❯</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pyocd</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> flash</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --target</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> stm32h750xx</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -v</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -O</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connect_mode=under-reset</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ./build/STM32H750XBH6_Template.bin@0x90000000</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000346</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Target</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> type</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> is</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> stm32h750xx</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">board</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000349</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 用户脚本：成功添加外部</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> QSPI</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Flash</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 区域</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">qspi_flash</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">pyocd_user</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000349</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Asserting</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> reset</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> prior</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> to</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connect</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">coresight_target</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000352</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> DP</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> IDR</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x6ba02477</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">v2 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">rev6</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dap</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000366</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CR:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x0070003f</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">target_STM32H750xx</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000370</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> AHB-AP#0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> IDR</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x84770001</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">AHB-AP </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">var0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> rev8</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">discovery</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000373</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> AHB-AP#1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> IDR</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x84770001</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">AHB-AP </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">var0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> rev8</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">discovery</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000376</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> APB-AP#2</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> IDR</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x54770002</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">APB-AP </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">var0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> rev5</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">discovery</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000379</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> AHB-AP#0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Class</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ROM</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> table</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> #0 @ 0xe00fe000 (designer=020:ST part=450) [rom_table]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000381</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">0</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e00ff000:ROM </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">1</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">4c7</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000381</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   AHB-AP#0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Class</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ROM</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> table</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> #1 @ 0xe00ff000 (designer=43b:Arm part=4c7) [rom_table]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000383</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">   </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">0</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e000e000:SCS v7-M </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">14</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">00c</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000385</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">   </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e0001000:DWT v7-M </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">14</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">002</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000386</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">   </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e0002000:FPB v7-M </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">14</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">00e</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000387</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">   </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">3</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e0000000:ITM v7-M </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">14</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">001</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000389</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e0041000:ETM M7 </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">9</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">975</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">13</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> archid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">4a13</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0:0:0</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000391</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e0043000:CTI CS-400 </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">9</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">906</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">14</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> archid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0000</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">40800:0:0</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000393</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> APB-AP#2</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Class</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ROM</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> table</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> #0 @ 0xe00e0000 (designer=020:ST part=450) [rom_table]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000396</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e00e3000:SWO CS-400 </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">9</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">914</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">11</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> archid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0000</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">ea0:0:0</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000398</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">3</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e00e4000:Trace Funnel CS-400 </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">9</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">908</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">12</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> archid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0000</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">32:0:0</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000399</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">4</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e00e5000:TSGEN </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">15</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">101</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000400</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">5</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e00f0000:ROM </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">1</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">020:ST</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">001</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000401</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   APB-AP#2</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Class</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ROM</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> table</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> #1 @ 0xe00f0000 (designer=020:ST part=001) [rom_table]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000404</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">   </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">0</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e00f1000:CTI CS-400 </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">9</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">906</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">14</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> archid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0000</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">40800:0:0</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000406</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">   </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e00f3000:Trace Funnel CS-400 </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">9</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">908</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">12</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> archid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0000</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">34:0:0</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000408</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">   </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">3</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e00f4000:ETF </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">9</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">961</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">32</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> archid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0000</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">380:0:0</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000410</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">   </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">4</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">e00f5000:TPIU CS-400 </span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">class</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">9</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> designer</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">43b:Arm</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> part</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">912</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devtype</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">11</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> archid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">0000</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> devid</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">a0:0:0</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#59873A;--shiki-dark:#80A665\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rom_table</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000415</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CPU</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> core</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> #0: Cortex-M7 r1p1, v7.0-M architecture [cortex_m]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000415</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   Extensions:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">DSP, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">FPU,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> FPU_DP,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> FPU_V5,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> MPU]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cortex_m</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000415</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   FPU</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> present:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> FPv5-D16-M</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cortex_m</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000416</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 4</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hardware</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> watchpoints</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dwt</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000419</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 8</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hardware</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> breakpoints,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> literal</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> comparators</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">fpb</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000431</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Deasserting</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> reset</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> post</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connect</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">coresight_target</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000433</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Creating</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> flash</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> algo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> for</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> region</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> qspi_flash</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> from:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /home/hao/projects/stm32_projects/STM32H750XBH6/CMake/STM32H750XBH6_Template/.config/FK750M6_XBH6_V0.FLM</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">flm_region_builder</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0000448</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Loading</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /home/hao/projects/stm32_projects/STM32H750XBH6/CMake/STM32H750XBH6_Template/build/STM32H750XBH6_Template.bin</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> at</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0x90000000</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">load_cmd</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span></span>\n<span class=\"line\"><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">==================================================</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> 100%</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">0002723</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> I</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Erased</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 65536</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bytes</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">1 </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">sector</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, programmed 65536 bytes </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">8</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pages</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, skipped 0 bytes </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">0</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> pages</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> at 28.14 kB/s </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">loader</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span></span></code></pre>\n<h3 id=\"实现效果\"><a class=\"anchor\" href=\"#实现效果\">#</a> 实现效果</h3>\n<ol>\n<li>\n<p><strong>Bootloader 日志 (运行于片内 Flash)</strong></p>\n<ul>\n<li>程序启动后，首先运行片内 Flash 中的 Bootloader，通过串口打印启动日志。</li>\n<li>Bootloader 日志截图 （乱码系中文编码问题）</li>\n</ul>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/20250803215422276.png\" alt=\"Snipaste_2025-08-03_21-16-45\" /></p>\n</li>\n<li>\n<p><strong>主程序日志 (运行于外部 QSPI Flash)</strong></p>\n<ul>\n<li>Bootloader 跳转到 QSPI Flash 中执行主程序，主程序通过 USB 虚拟串口打印运行日志。</li>\n<li>USB 虚拟串口日志截图</li>\n</ul>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/20250803215435181.png\" alt=\"Snipaste_2025-08-03_21-17-15\" /></p>\n</li>\n</ol>\n<p>串口波特率115200</p>\n<h3 id=\"特别鸣谢\"><a class=\"anchor\" href=\"#特别鸣谢\">#</a> 特别鸣谢</h3>\n<p><strong>反客科技</strong>：提供开发板资料和.FLM格式下载算法</p>\n<p><strong>反客交流群的Peakors大佬</strong>：提供STM32H750XHB6的项目模板和openocd外部下载算法，他还制作了很多反客开发板的项目模板和下载算法，<a href=\"https://github.com/Peakors\">GitHub主页</a>。</p>\n<p><strong>谷歌Gemini</strong>：消化pyocd的文档，提供指导建议和文章排版</p>\n",
            "tags": [
                "MCU/单片机/微控制器",
                "pyocd/openocd"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/08/02/%E4%BD%BF%E7%94%A8Docker%E7%BC%96%E8%AF%91OpenWrt/",
            "url": "https://haoruanwn.github.io/2025/08/02/%E4%BD%BF%E7%94%A8Docker%E7%BC%96%E8%AF%91OpenWrt/",
            "title": "使用Docker编译OpenWrt",
            "date_published": "2025-08-01T17:11:17.000Z",
            "content_html": "<h1 id=\"使用docker编译openwrt\"><a class=\"anchor\" href=\"#使用docker编译openwrt\">#</a> 使用Docker编译OpenWrt</h1>\n<p>介绍如何利用 Docker 环境编译 OpenWrt 固件，以实现编译环境的隔离和一致性。</p>\n<h2 id=\"前提条件\"><a class=\"anchor\" href=\"#前提条件\">#</a> 前提条件</h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">类别</th>\n<th style=\"text-align:left\">要求</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>网络环境</strong></td>\n<td style=\"text-align:left\">良好的科学上网环境，确保可以顺畅访问 GitHub、OpenWrt 源码等国外资源。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>软件工具</strong></td>\n<td style=\"text-align:left\">在宿主机上预先安装好 <code>Git</code> 和 <code>Docker</code> (包括 <code>docker-compose</code>)。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>个人能力</strong></td>\n<td style=\"text-align:left\">具备基本的 Linux 命令行操作和解决问题的能力。</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"环境搭建\"><a class=\"anchor\" href=\"#环境搭建\">#</a> 环境搭建</h2>\n<h3 id=\"1-dockerfile\"><a class=\"anchor\" href=\"#1-dockerfile\">#</a> 1. Dockerfile</h3>\n<p>创建一个 <code>Dockerfile</code> 文件，用于定义编译环境镜像。该镜像基于 Ubuntu 22.04，安装了所有 OpenWrt 官方推荐的编译依赖，并创建了一个名为 <code>builder</code> 的非 root 用户以增强安全性。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-dockerfile\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 使用官方推荐的 Ubuntu 22.04 LTS 作为基础镜像</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">FROM</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> ubuntu:22.04</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 设置环境变量，避免在包安装过程中出现交互式提示</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">ENV</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> DEBIAN_FRONTEND=noninteractive</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 一次性更新软件源并安装 OpenWrt 编译所需的所有依赖包</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">RUN</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> apt-get update &#x26;&#x26; \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    apt-get install -y --no-install-recommends \\</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 编译工具链</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    build-essential \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    clang \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    flex \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    bison \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    g++ \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    gawk \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    gcc-multilib \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    g++-multilib \\</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 文本和版本控制工具</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    gettext \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    git \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    subversion \\</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 核心库和开发头文件</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    libncurses5-dev \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    libssl-dev \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    zlib1g-dev \\</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # Python 相关工具</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    python3-distutils \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    python3-docutils \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    python3-pyelftools \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    python3-setuptools \\</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 常用辅助工具</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    rsync \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    swig \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    texinfo \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    unzip \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    wget \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    file \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    time \\</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 解决 SSL 证书验证问题的关键包</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    ca-certificates \\</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 为非 root 用户提供提权能力的工具</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    sudo \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    &#x26;&#x26; \\</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 清理 apt 缓存，减小最终镜像大小</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    apt-get clean &#x26;&#x26; \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    rm -rf /var/lib/apt/lists/*</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 创建一个名为 'builder' 的非 root 用户，并赋予其免密 sudo 权限</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 这是为了安全起见，避免在容器中直接使用 root 用户进行编译等操作</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">RUN</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> useradd -m -s /bin/bash builder &#x26;&#x26; \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    adduser builder sudo &#x26;&#x26; \\</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    echo </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">'builder ALL=(ALL) NOPASSWD:ALL'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> /etc/sudoers</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 切换到新创建的非 root 用户</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">USER</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> builder</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 为 builder 用户设置工作目录</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">WORKDIR</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> /home/builder</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 设置容器启动时执行的默认命令，即启动一个 bash shell</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">CMD</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"/bin/bash\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span></code></pre>\n<h3 id=\"2-docker-composeyml\"><a class=\"anchor\" href=\"#2-docker-composeyml\">#</a> 2. docker-compose.yml</h3>\n<p>创建 <code>docker-compose.yml</code> 文件来管理容器的构建和运行。该配置会自动构建镜像，并设置一个关键的卷挂载，将宿主机的 <code>./openwrt</code> 目录映射到容器内，使得源码和编译产物能够持久化保存在宿主机上。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-yaml\"><span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">version</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">3.8</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">services</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">  openwrt-builder</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 使用当前目录下的 Dockerfile 来构建镜像</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    build</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> .</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 给构建出的镜像命名</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    image</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> openwrt-builder-image</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 容器的名字</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    container_name</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> openwrt_build_env</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 覆盖 Dockerfile 中的 CMD，确保我们能进入 bash</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    command</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /bin/bash</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 保持容器在前台运行，并分配一个伪终端 (等同于 -it)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    stdin_open</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> true</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    tty</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> true</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 网络模式</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    network_mode</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> host</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 挂载卷</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    volumes</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">      # 将宿主机的 ./openwrt 目录挂载到容器的 /home/builder/openwrt</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">      -</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ./openwrt:/home/builder/openwrt</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 设置工作目录，进入容器后会自动切换到这个目录</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    working_dir</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /home/builder/openwrt</span></span></code></pre>\n<h3 id=\"3-推荐目录结构\"><a class=\"anchor\" href=\"#3-推荐目录结构\">#</a> 3. 推荐目录结构</h3>\n<p>为了便于管理，建议采用以下目录结构：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-plaintext\"><span class=\"line\"><span>~/openwrt_dev/</span></span>\n<span class=\"line\"><span>├── Dockerfile</span></span>\n<span class=\"line\"><span>├── docker-compose.yml</span></span>\n<span class=\"line\"><span>└── openwrt/</span></span></code></pre>\n<p>其中 <code>openwrt</code> 目录为 OpenWrt 源码。</p>\n<h2 id=\"编译步骤\"><a class=\"anchor\" href=\"#编译步骤\">#</a> 编译步骤</h2>\n<h3 id=\"1-获取openwrt源码\"><a class=\"anchor\" href=\"#1-获取openwrt源码\">#</a> 1. 获取OpenWrt源码</h3>\n<p>在 <code>~/openwrt_dev/</code> 目录下，克隆 OpenWrt 官方源码。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">git</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> clone</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> https://git.openwrt.org/openwrt/openwrt.git</span></span></code></pre>\n<h3 id=\"2-构建镜像与启动容器\"><a class=\"anchor\" href=\"#2-构建镜像与启动容器\">#</a> 2. 构建镜像与启动容器</h3>\n<p>在 <code>~/openwrt_dev/</code> 目录下执行以下命令，Docker Compose 会自动根据 <code>Dockerfile</code> 构建镜像，并根据 <code>docker-compose.yml</code> 的配置启动容器。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 作者安装的docker比较新，把docker-compose整合到docker工具链中了，使用方式和旧版不太一样</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compose</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> up</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --build</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -d</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 旧版 docker-compose</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">docker-compose</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> up</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --build</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -d</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 查看容器情况</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ps</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -a</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 启动或关闭我们的容器</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> start</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> openwrt_build_env</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> stop</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> openwrt_build_env</span></span></code></pre>\n<p>使用 <code>-d</code> 参数可以在后台启动容器。</p>\n<h3 id=\"3-进入容器\"><a class=\"anchor\" href=\"#3-进入容器\">#</a> 3. 进入容器</h3>\n<p>容器启动后，使用 <code>docker exec</code> 命令进入容器内部的 <code>bash</code> 环境。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">docker</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> exec</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -it</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> openwrt_build_env</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bash</span></span></code></pre>\n<h3 id=\"4-执行编译\"><a class=\"anchor\" href=\"#4-执行编译\">#</a> 4. 执行编译</h3>\n<p>进入容器后，所有操作都在 <code>/home/builder/openwrt</code> 目录下进行。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 1. 更新并安装 Feeds</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">./scripts/feeds</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> update</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -a</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">./scripts/feeds</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -a</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 2. 生成默认配置文件，并进入配置菜单</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#    在这里选择你的目标设备型号、软件包等</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#    本文章的重点不在于此，不再展开</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">make</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> menuconfig</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 3. 下载编译所需的依赖包</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">make</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> download</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -j</span><span style=\"color:#999999;--shiki-dark:#666666\">$(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">nproc</span><span style=\"color:#999999;--shiki-dark:#666666\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 4. 开始编译 (使用与CPU核心数相当的线程数以加快速度)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">make</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -j</span><span style=\"color:#999999;--shiki-dark:#666666\">$(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">nproc</span><span style=\"color:#999999;--shiki-dark:#666666\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> V=s</span></span></code></pre>\n<h2 id=\"编译产物\"><a class=\"anchor\" href=\"#编译产物\">#</a> 编译产物</h2>\n<p>编译成功后，生成的固件及相关文件会位于宿主机的 <code>~/openwrt_dev/openwrt/bin/targets/</code> 目录下，具体路径取决于你在 <code>make menuconfig</code> 中选择的目标平台。例如，<code>mediatek/filogic</code> 平台的产物路径如下：</p>\n<p><strong>路径:</strong> <code>~/openwrt_dev/openwrt/bin/targets/mediatek/filogic/</code></p>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/20250802005325556.png\" alt=\"Snipaste_2025-08-02_00-33-20\" /></p>\n",
            "tags": [
                "OpenWrt"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/31/CMake%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AF%BB%E6%89%BE%E4%BE%9D%E8%B5%96%E5%92%8C%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BA%93/",
            "url": "https://haoruanwn.github.io/2025/07/31/CMake%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AF%BB%E6%89%BE%E4%BE%9D%E8%B5%96%E5%92%8C%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BA%93/",
            "title": "CMake使用示例：寻找依赖和自定义库",
            "date_published": "2025-07-31T14:09:44.000Z",
            "content_html": "<h2 id=\"一-添加第三方依赖示例\"><a class=\"anchor\" href=\"#一-添加第三方依赖示例\">#</a> 一、添加第三方依赖示例</h2>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">cmake_minimum_required</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">VERSION</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> 3.10</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">project</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">find_demo</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 添加可执行文件</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">add_executable</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    main.cpp</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 寻找gflags库，REQUIRED表示必须找到，否则报错</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">find_package</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">gflags REQUIRED</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">if</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">gflags_FOUND</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"gflags found: $&#123;gflags_INCLUDE_DIRS&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"gflags library: $&#123;gflags_LIBRARIES&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 为可执行文件添加头文件目录和库目录</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    target_include_directories</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> PRIVATE</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">gflags_INCLUDE_DIRS</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    target_link_libraries</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> PRIVATE</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">gflags_LIBRARIES</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">else</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">FATAL_ERROR </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"gflags not found\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">endif</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">变量名</th>\n<th style=\"text-align:center\">作用</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\"><code>gflags_INCLUDE_DIRS</code></td>\n<td style=\"text-align:center\">GFlags 头文件目录（如 <code>/usr/include/gflags/</code>）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"><code>gflags_LIBRARIES</code></td>\n<td style=\"text-align:center\">GFlags 库文件路径（如 <code>/usr/lib/libgflags.so</code> 或 <code>libgflags.a</code>）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"><code>gflags_FOUND</code></td>\n<td style=\"text-align:center\">布尔值，标记是否找到 GFlags</td>\n</tr>\n</tbody>\n</table>\n<p>这些变量是由<code>find_package(gflags)</code> 命令自动生成的</p>\n<h2 id=\"二-自己编写依赖库\"><a class=\"anchor\" href=\"#二-自己编写依赖库\">#</a> 二、自己编写依赖库</h2>\n<p>两种情况：</p>\n<ol>\n<li>\n<p>非cmake安装的库：</p>\n<p>需要提供<code>Find&lt;lib name&gt;.cmake</code>，如<code>Finddlib.cmake</code></p>\n</li>\n<li>\n<p>使用cmake安装的库：</p>\n<p>使用<code>install</code>安装，生成<code>&lt;lib name&gt;Config.cmake</code>文件，适用于导入自己开发的cmake项目</p>\n</li>\n</ol>\n<h3 id=\"1-非cmake安装的库\"><a class=\"anchor\" href=\"#1-非cmake安装的库\">#</a> 1、非cmake安装的库</h3>\n<p>项目结构：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">.</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CMakeLists.txt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> cmake</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Finddlib.cmake</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">└──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> main.cpp</span></span></code></pre>\n<p><code>CMakeLists.txt</code></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">cmake_minimum_required</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">VERSION</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> 3.10</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">project</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">find_demo</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 设置CMAKE_MODULE_PATH，添加自定义模块的路径，find_package会从这里查找Findlib.cmake文件</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_MODULE_PATH</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">CMAKE_CURRENT_LIST_DIR</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/cmake</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 使用find_package查找自定义模块，会从CMAKE_MODULE_PATH中查找</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">find_package</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib REQUIRED</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">if</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_FOUND</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib found: $&#123;dlib_INCLUDE_DIR&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib library: $&#123;dlib_LIBRARY&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib version: $&#123;dlib_VERSION&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib author: $&#123;dlib_AUTHOR&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib lib dir: $&#123;dlib_LIBRARY_DIR&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">else</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">FATAL_ERROR </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib not found\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">endif</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 设置RPATH</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_BUILD_WITH_INSTALL_RPATH</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> TRUE</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_INSTALL_RPATH</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> \"$&#123;dlib_LIBRARY_DIR&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 添加可执行文件</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">add_executable</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    main.cpp</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 添加头文件</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">target_include_directories</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> PRIVATE</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">dlib_INCLUDE_DIR</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 链接动态库</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">target_link_libraries</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> PRIVATE</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">dlib_LIBRARY</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><code>./cmake/Finddlib.cmake</code>，顶层<code>CMakeLists.txt</code>通过这个文件来查找依赖库</p>\n<p>因此，需要自己编写，设置对应的库路径和头文件路径</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 找 dlib.h</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">find_path</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_INCLUDE_DIR</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    NAMES</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> dlib.h</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    PATHS</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> /home/hao/installed/</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">test</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/include</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 找 libdlib.so</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">find_library</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_LIBRARY</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    NAMES</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> dlib</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    PATHS</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> /home/hao/installed/</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">test</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/lib</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 如果dlib.h和libdlib.so都找到了，就设置dlib_FOUND为true</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">if</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_INCLUDE_DIR </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">AND</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> dlib_LIBRARY</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_FOUND </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">TRUE</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 设置dlib的版本和作者信息</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_VERSION </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"1.0.0\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_AUTHOR </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"hao\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # lib文件所在的目录</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    get_filename_component</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_LIBRARY_DIR </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">dlib_LIBRARY</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> DIRECTORY</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">else</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_FOUND </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">FALSE</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">endif</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>输出结果：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">❯</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> cmake</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -S</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> .</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -B</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> build</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> The</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> C</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compiler</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> identification</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> is</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> GNU</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 11.4.0</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> The</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CXX</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compiler</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> identification</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> is</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> GNU</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 11.4.0</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Detecting</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> C</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compiler</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ABI</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> info</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Detecting</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> C</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compiler</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ABI</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> info</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> done</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Check</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> for</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> working</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> C</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compiler:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /usr/bin/cc</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> skipped</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Detecting</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> C</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compile</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> features</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Detecting</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> C</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compile</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> features</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> done</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Detecting</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CXX</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compiler</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ABI</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> info</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Detecting</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CXX</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compiler</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ABI</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> info</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> done</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Check</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> for</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> working</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CXX</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compiler:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /usr/bin/c++</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> skipped</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Detecting</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CXX</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compile</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> features</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Detecting</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CXX</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> compile</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> features</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> -</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> done</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlib</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> found:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /home/hao/installed/test/include</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlib</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> library:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /home/hao/installed/test/lib/libdlib.so</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlib</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> version:</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1.0.0</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlib</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> author:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> hao</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlib</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> lib</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dir:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /home/hao/installed/test/lib</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Configuring</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> done</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Generating</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> done</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">--</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Build</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> files</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> have</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> been</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> written</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> to:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /home/hao/cpp-cmake_learn/cmake_projects/custom_find/find_demo/build</span></span></code></pre>\n<h3 id=\"2-cmake安装的库\"><a class=\"anchor\" href=\"#2-cmake安装的库\">#</a> 2、cmake安装的库</h3>\n<p>项目结构：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">.</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 1.custom_mod</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   ├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CMakeLists.txt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   ├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> cmake</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   │</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlibConfig.cmake.in</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   ├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> include</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   │</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlib.h</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> src</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">       └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlib.cpp</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">└──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 2.find_test</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    ├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CMakeLists.txt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> main.cpp</span></span></code></pre>\n<p><strong>自己的cmake编写和安装的库：</strong></p>\n<p><code>CMakeLists.txt</code>中的</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_INSTALL_PREFIX</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> \"/home/hao/installed/test\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 路径被两次引用，1、编译dlib；2、install export写入config时，所以会报错</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 添加头文件目录</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">target_include_directories</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib </span><span style=\"color:#59873A;--shiki-dark:#80A665\">PUBLIC</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> include</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># # 使用生成器表达式，解决路径被两次引用的问题</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># target_include_directories(dlib PUBLIC</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#         $&#x3C;BUILD_INTERFACE:$&#123;CMAKE_SOURCE_DIR&#125;/include>  # 生成时的头文件目录</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#         $&#x3C;INSTALL_INTERFACE:include>                    # 安装时的头文件目录</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># )</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 设置公共头文件</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set_target_properties</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib PROPERTIES </span><span style=\"color:#59873A;--shiki-dark:#80A665\">PUBLIC_HEADER</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> include/dlib.h</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 添加安装</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">install</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">TARGETS dlib</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    EXPORT</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> dlib      </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 导出目标</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    RUNTIME DESTINATION bin </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 可执行文件</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    LIBRARY DESTINATION lib </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 动态库</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    ARCHIVE DESTINATION lib </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 静态库</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    PUBLIC_HEADER</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> DESTINATION include </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 公共头文件，只有在设置了 PUBLIC_HEADER 时才会安装，或者使用下面一句</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 通过模板生成 &#x3C;Package>Config.cmake，用于 find_package() 寻找包，可以包装一些信息，比如版本号等</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">TARGET_NAME dlib</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">install</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">EXPORT dlib</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    FILE</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">TARGET_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">Target</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">.cmake</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    DESTINATION config</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">CMakePackageConfigHelpers</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># configure_package_config_file 参数：模板文件，生成文件，安装路径</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">configure_package_config_file</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">CMAKE_SOURCE_DIR</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/cmake/</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">TARGET_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Config.cmake.in</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">TARGET_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Config.cmake</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    INSTALL_DESTINATION config</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 将生成的 &#x3C;Package>Config.cmake 安装到 $&#123;CMAKE_INSTALL_PREFIX&#125;/config 目录下</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># CMAKE_CURRENT_BINARY_DIR 为当前编译目录</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">install</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> FILES</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">CMAKE_CURRENT_BINARY_DIR</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">TARGET_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Config.cmake</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    DESTINATION config</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p>安装路径为<code>/home/hao/installed/test</code></p>\n<p><code>dlibConfig.cmake.in</code></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">@PACKAGE_INIT@</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">CMakeFindDependencyMacro</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"$&#123;CMAKE_CURRENT_LIST_DIR&#125;/dlibTarget.cmake\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">check_required_components</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"@TARGET_NAME@\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">get_target_property</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">@TARGET_NAME@_INCLUDE_DIR @TARGET_NAME@ </span><span style=\"color:#59873A;--shiki-dark:#80A665\">INTERFACE_INCLUDE_DIRECTORIES</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">@TARGET_NAME@_LIBRARIES @TARGET_NAME@</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">@TARGET_NAME@_AUTHOR ENPEI</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><strong>引用库的项目</strong></p>\n<p>顶层<code>CMakeLists.txt</code>：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 首先会在CMAKE_MODULE_PATH中查找Finddlib.cmake文件</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 如果找不到，会在CMAKE_PREFIX_PATH中查找dlibConfig.cmake配置文件</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># set(CMAKE_PREFIX_PATH  \"~/Documents/course_lib/config\")</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">find_package</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib REQUIRED</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">if</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_FOUND</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib_FOUND: $&#123;dlib_FOUND&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib_INCLUDE_DIR: $&#123;dlib_INCLUDE_DIR&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib_LIBRARIES: $&#123;dlib_LIBRARIES&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib_AUTHOR: $&#123;dlib_AUTHOR&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 获取$&#123;dlib_INCLUDE_DIR&#125;的父目录</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    get_filename_component</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib_INCLUDE_DIR_PARENT </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">dlib_INCLUDE_DIR</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> DIRECTORY</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib_INCLUDE_DIR_PARENT: $&#123;dlib_INCLUDE_DIR_PARENT&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">else</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">FATAL_ERROR </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"dlib not found\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">endif</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 设置RPATH，否则install后，运行时找不到动态库</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">SET</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_BUILD_WITH_INSTALL_RPATH</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> TRUE</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">SET</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_INSTALL_RPATH</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> \"$&#123;dlib_INCLUDE_DIR_PARENT&#125;/lib\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n",
            "tags": [
                "Programing",
                "CMake"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/31/CMake%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AE%89%E8%A3%85%E8%AE%BE%E7%BD%AE/",
            "url": "https://haoruanwn.github.io/2025/07/31/CMake%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%EF%BC%9A%E5%AE%89%E8%A3%85%E8%AE%BE%E7%BD%AE/",
            "title": "CMake使用示例：安装设置",
            "date_published": "2025-07-31T14:08:33.000Z",
            "content_html": "<h1 id=\"说明\"><a class=\"anchor\" href=\"#说明\">#</a> 说明</h1>\n<p>发布项目时需要指定项目文件的安装路径<br />\n这里的路径是相对于<code>CMAKE_INSTALL_PREFIX</code>的路径，比如可执行文件就会在<code>$&#123;CMAKE_INSTALL_PREFIX&#125;/bin</code>下<br />\n需要指定<code>CMAKE_INSTALL_PREFIX</code>的路径，如果不指定，默认是<code>/usr/local</code></p>\n<p><strong>安装可执行文件和库：</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">install</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">TARGETS test_account</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    RUNTIME DESTINATION bin </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 可执行文件</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    LIBRARY DESTINATION lib </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 动态库</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    ARCHIVE DESTINATION lib </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 静态库</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<p><strong>安装头文件：</strong></p>\n<ol>\n<li>\n<p>单独安装</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">install</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">DIRECTORY </span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    include</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/ DESTINATION include</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n</li>\n<li>\n<p>和其他文件一起安装</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">install</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">TARGETS test_account</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    RUNTIME DESTINATION bin </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 可执行文件</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    LIBRARY DESTINATION lib </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 动态库</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    ARCHIVE DESTINATION lib </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 静态库</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    PUBLIC_HEADER</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> DESTINATION include </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 公共头文件</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n</li>\n</ol>\n<h1 id=\"使用示例\"><a class=\"anchor\" href=\"#使用示例\">#</a> 使用示例</h1>\n<p>项目结构</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">.</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CMakeLists.txt</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> include</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   ├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlib.h</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> slib.h</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> main.cpp</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> # 入口文件</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">└──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> src</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    ├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlib.cpp</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> slib.cpp</span></span></code></pre>\n<p><code>CMakeLists.txt</code></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">cmake_minimum_required</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">VERSION</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> 3.10</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">project</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">install_demo</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">CMAKE_CXX_STANDARD 11</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 添加公共头文件路径</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include_directories</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">CMAKE_CURRENT_SOURCE_DIR</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/include</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 添加静态库</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">add_library</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">slib STATIC</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    src/slib.cpp</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    include</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/slib.h</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 添加动态库</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">add_library</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dlib SHARED</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    src/dlib.cpp</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    include</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/dlib.h</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 设置安装路径</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_INSTALL_PREFIX</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> \"/home/hao/installed/test\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_BUILD_WITH_INSTALL_RPATH</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> TRUE</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_INSTALL_RPATH</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> \"$&#123;CMAKE_INSTALL_PREFIX&#125;/lib\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 添加可执行文件</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">add_executable</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    main.cpp</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 添加链接库</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">target_link_libraries</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    slib</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    dlib</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 打印安装路径默认值</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"CMAKE_INSTALL_PREFIX: $&#123;CMAKE_INSTALL_PREFIX&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">install</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">DIRECTORY </span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    include</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/ DESTINATION include</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 安装</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">install</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">TARGETS </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> slib dlib</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    RUNTIME DESTINATION bin</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    LIBRARY DESTINATION lib</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    ARCHIVE DESTINATION lib</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n<h2 id=\"一-安装流程\"><a class=\"anchor\" href=\"#一-安装流程\">#</a> 一、安装流程</h2>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 生成cmake配置文件</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cmake</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -S</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> .</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -B</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -DCMAKE_INSTALL_PREFIX=./installed</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cmake</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -S</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> .</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -B</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> build</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> # 如果不指定安装目录，使用cmake中已经写好的或者默认值</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 编译</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cmake</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --build</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> build</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 安装</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cmake</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --install</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> build</span></span></code></pre>\n<p>安装结果：</p>\n<p><code>\\home\\hao\\installed\\test</code></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">.</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bin</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> install_demo</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> include</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   ├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dlib.h</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">│</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">   └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> slib.h</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">└──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> lib</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    ├──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> libdlib.so</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    └──</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> libslib.a</span></span></code></pre>\n<h2 id=\"二-设置运行时库搜索路径rpath\"><a class=\"anchor\" href=\"#二-设置运行时库搜索路径rpath\">#</a> 二、设置运行时库搜索路径(RPATH)</h2>\n<p>设置可执行文件运行时搜索动态库的路径</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_BUILD_WITH_INSTALL_RPATH</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> TRUE</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_INSTALL_RPATH</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> \"$&#123;CMAKE_INSTALL_PREFIX&#125;/lib\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span></code></pre>\n<p>默认情况下，CMake在构建时会使用构建目录下的库路径（如 <code>build/lib/</code>），但安装后会切换到 <code>$&#123;CMAKE_INSTALL_PREFIX&#125;/lib</code>。此设置强制让构建阶段和安装阶段的 RPATH 一致，避免运行时因路径切换找不到库。</p>\n<p>**注意：**需要放在<code>add_executable</code>前面</p>\n",
            "tags": [
                "Programing",
                "CMake"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/Programing/Rust/Rust%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/",
            "url": "https://haoruanwn.github.io/2025/07/28/Programing/Rust/Rust%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/",
            "title": "rust基本语法",
            "date_published": "2025-07-28T13:49:13.000Z",
            "content_html": "<h1 id=\"rust-基本语法\"><a class=\"anchor\" href=\"#rust-基本语法\">#</a> rust 基本语法</h1>\n<h2 id=\"1-变量与可变性\"><a class=\"anchor\" href=\"#1-变量与可变性\">#</a> 1. 变量与可变性</h2>\n<p>rust 中的变量默认是 <strong>不可变</strong> 的。可以使用 <code>mut</code> 关键字使变量变为 <strong>可变</strong> 的。</p>\n<h3 id=\"11-可变变量\"><a class=\"anchor\" href=\"#11-可变变量\">#</a> 1.1 可变变量</h3>\n<p>通过 <code>mut</code> 关键字，可以声明一个可变变量，其值在后续可以被修改。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 可变变量</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> mut</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 5</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">println!</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The value of x is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">x</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">println!</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The value of x is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h3 id=\"12-常量\"><a class=\"anchor\" href=\"#12-常量\">#</a> 1.2 常量</h3>\n<p>常量在绑定值后任何时候都不能更改。</p>\n<ul>\n<li><strong>声明</strong>: 使用 <code>const</code> 关键字，且必须显式标注值的类型。</li>\n<li><strong>命名</strong>: rust 常量的命名约定是使用全大写字母，并用下划线分隔单词。</li>\n<li><strong>赋值</strong>: 只能被设置为常量表达式，不能是函数调用的结果或任何其他在运行时才能确定的值。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>// 常量 不可用mut，必须标注类型，仅可以用常量表达式赋值</span></span>\n<span class=\"line\"><span>const SPECAL_NUMBER: i32 = 3;</span></span>\n<span class=\"line\"><span>println!(\"The value of SPECAL_NUMBER is: &#123;&#125;\", SPECAL_NUMBER);</span></span></code></pre>\n<h3 id=\"13-变量遮蔽-shadowing\"><a class=\"anchor\" href=\"#13-变量遮蔽-shadowing\">#</a> 1.3 变量遮蔽 (Shadowing)</h3>\n<p>rust 允许声明一个与之前变量同名的新变量，这个过程称为遮蔽 (Shadowing)。新变量会“遮蔽”掉旧的变量。</p>\n<ul>\n<li>它通过再次使用 <code>let</code> 关键字来创建了一个全新的变量。</li>\n<li>这允许我们改变值的类型，同时保持名称不变。</li>\n<li>在离开作用域后，被遮蔽的变量会恢复。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 变量遮蔽</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_number</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 5</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 这里的my_number是一个新的变量，遮蔽了原来的 5</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_number</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_number</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> +</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 在这个内部作用域，my_number又被一次遮蔽</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_number</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_number</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    println!</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The value of my_number in the inner scope is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_number</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 输出 12</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">println!</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The value of my_number is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_number</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 输出 6</span></span></code></pre>\n<h2 id=\"2-数据类型\"><a class=\"anchor\" href=\"#2-数据类型\">#</a> 2. 数据类型</h2>\n<p>rust 是一种静态类型语言，它在编译时就必须知道所有变量的类型。数据类型可以分为两大类：<strong>标量类型</strong>和<strong>复合类型</strong>。</p>\n<h3 id=\"21-标量类型-scalar-types\"><a class=\"anchor\" href=\"#21-标量类型-scalar-types\">#</a> 2.1 标量类型 (Scalar Types)</h3>\n<p>标量类型表示一个单一的值。rust 有四种主要的标量类型：</p>\n<table>\n<thead>\n<tr>\n<th>类型</th>\n<th>说明</th>\n<th>示例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>整数</strong></td>\n<td>有符号 (<code>i8</code> 到 <code>i128</code>, <code>isize</code>) 和无符号 (<code>u8</code> 到 <code>u128</code>, <code>usize</code>)</td>\n<td><code>let int1 = 98_222;</code></td>\n</tr>\n<tr>\n<td><strong>浮点数</strong></td>\n<td><code>f32</code> (单精度) 和 <code>f64</code> (双精度)</td>\n<td><code>const PI: f64 = 3.14159;</code></td>\n</tr>\n<tr>\n<td><strong>布尔值</strong></td>\n<td><code>bool</code>，值为 <code>true</code> 或 <code>false</code></td>\n<td><code>let is_rust_fun = true;</code></td>\n</tr>\n<tr>\n<td><strong>字符</strong></td>\n<td><code>char</code>，表示一个 Unicode 标量值，用单引号括起来</td>\n<td><code>let char1 = 'z';</code> <code>let char2 = '😻';</code></td>\n</tr>\n</tbody>\n</table>\n<p><strong>整数的字面量表示:</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> int1</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 98_222</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">       // 十进制，下划线可用于提高可读性</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> int2</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0xff</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">         // 十六进制</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> int3</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0o77</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">         // 八进制</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> int4</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0b1111_0000</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">   // 二进制</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> int5</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> b</span><span style=\"color:#999999;--shiki-dark:#666666\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">A</span><span style=\"color:#999999;--shiki-dark:#666666\">'</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">         // 字节 (u8)</span></span></code></pre>\n<h3 id=\"22-复合类型-compound-types\"><a class=\"anchor\" href=\"#22-复合类型-compound-types\">#</a> 2.2 复合类型 (Compound Types)</h3>\n<p>复合类型可以将多个值组合成一个类型。rust 有两种原生的复合类型：</p>\n<h4 id=\"元组-tuple\"><a class=\"anchor\" href=\"#元组-tuple\">#</a> 元组 (Tuple)</h4>\n<ul>\n<li>将多个不同类型的值组合进一个复合类型中。</li>\n<li>长度固定：一旦声明，其大小不能伸缩。</li>\n<li>可以通过模式匹配进行 <strong>解构 (Destructuring)</strong>，或使用点号 <code>.</code> 加索引来访问元素。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 元组 不同数据类型的组合</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_tuple</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">i32</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> f64</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> u8</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">500</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 6</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 解构元组</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">x</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> z</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_tuple</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">println!</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The value of y is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 通过索引访问</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> five_hundred</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> my_tuple</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">println!</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The first value is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> five_hundred</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h4 id=\"数组-array\"><a class=\"anchor\" href=\"#数组-array\">#</a> 数组 (Array)</h4>\n<ul>\n<li>将多个 <strong>相同类型</strong> 的值组合在一起。</li>\n<li>长度固定。</li>\n<li>数据存储在栈上。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> a</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">10</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 20</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 30</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 40</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 50</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> first</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> a</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 访问数组元素</span></span></code></pre>\n<h2 id=\"3-函数\"><a class=\"anchor\" href=\"#3-函数\">#</a> 3. 函数</h2>\n<p>使用 <code>fn</code> 关键字定义函数。rust 代码使用蛇形命名法 (snake case) 作为函数和变量名称的规范。</p>\n<h3 id=\"31-函数参数\"><a class=\"anchor\" href=\"#31-函数参数\">#</a> 3.1 函数参数</h3>\n<p>必须为每个参数声明其类型。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> another_function</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> i32</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> String</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    println!</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The value of x is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    println!</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The value of y is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h3 id=\"32-语句和表达式\"><a class=\"anchor\" href=\"#32-语句和表达式\">#</a> 3.2 语句和表达式</h3>\n<ul>\n<li><strong>语句 (Statements)</strong>: 执行某些操作但不返回值的指令。例如 <code>let x = 6;</code>。</li>\n<li><strong>表达式 (Expressions)</strong>: 会计算并产生一个值。例如 <code>5 + 6</code>。</li>\n<li>函数体由一系列语句和一个可选的结尾表达式构成。</li>\n<li>在 rust 中，代码块 <code>&#123;&#125;</code> 是一个表达式，它会返回块中最后一个表达式的值。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 5</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> +</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 这个块表达式的返回值是 6，注意末尾没有分号</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">println!</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The value of y is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // y 的值为 6</span></span></code></pre>\n<h3 id=\"33-函数返回值\"><a class=\"anchor\" href=\"#33-函数返回值\">#</a> 3.3 函数返回值</h3>\n<ul>\n<li>在箭头 <code>-&gt;</code> 之后声明返回值的类型。</li>\n<li>函数的返回值是其函数体中最后一个表达式的值。</li>\n<li>可以使用 <code>return</code> 关键字提前从函数中返回。</li>\n<li>没有显式返回值的函数，其返回类型是 <code>()</code>，称为单元类型 (unit type)。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 含返回值的函数</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> five</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> i32</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">    5</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 这是一个表达式，其值将作为函数返回值</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> plus_one</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> i32</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> i32</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> +</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 也可以使用 return 显式返回</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h2 id=\"4-控制流\"><a class=\"anchor\" href=\"#4-控制流\">#</a> 4. 控制流</h2>\n<h3 id=\"41-if-表达式\"><a class=\"anchor\" href=\"#41-if-表达式\">#</a> 4.1 <code>if</code> 表达式</h3>\n<ul>\n<li><code>if</code> 表达式的条件必须是 <code>bool</code> 类型。</li>\n<li>因为 <code>if</code> 是一个表达式，所以可以将其用在 <code>let</code> 语句的右侧来赋值。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> if_function</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> i32</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 5</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        println!</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">x is less than 5</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> if</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> ==</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 5</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        println!</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">x is equal to 5</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        println!</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">x is greater than 5</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // if表达式可以返回值</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> if</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> +</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    println!</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The value of y is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h3 id=\"42-循环\"><a class=\"anchor\" href=\"#42-循环\">#</a> 4.2 循环</h3>\n<p>rust 提供了三种循环：<code>loop</code>、<code>while</code> 和 <code>for</code>。</p>\n<h4 id=\"loop\"><a class=\"anchor\" href=\"#loop\">#</a> <code>loop</code></h4>\n<ul>\n<li><code>loop</code> 关键字告诉 rust 无限次地执行一块代码，直到你显式地告诉它停止。</li>\n<li>可以使用 <code>break</code> 关键字退出循环，<code>break</code> 后面可以跟一个表达式，作为 <code>loop</code> 循环的返回值。</li>\n<li>可以使用 <code>continue</code> 跳过当前迭代，进入下一次迭代。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> loop_function</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> i32</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    let</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> mut</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> counter</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    loop</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        counter</span><span style=\"color:#999999;--shiki-dark:#666666\"> +=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> counter</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> ==</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            break</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> counter</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 退出循环并返回 20</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h4 id=\"循环标签-loop-labels\"><a class=\"anchor\" href=\"#循环标签-loop-labels\">#</a> 循环标签 (Loop Labels)</h4>\n<p>对于嵌套循环，可以使用循环标签来指定 <code>break</code> 或 <code>continue</code> 要作用于哪个循环。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> labeled_loop</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    let</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> mut</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> count</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    '</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">counting_up</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">:</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> loop</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        println!</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">count = </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">count</span><span style=\"color:#999999;--shiki-dark:#666666\">&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">        let</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> mut</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> remaining</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 10</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        loop</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            println!</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">remaining = </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> remaining</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            if</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> remaining</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> ==</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 9</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a13865;--shiki-dark:#d9739f\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">                break</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 退出内层循环</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">            </span><span style=\"color:#a13865;--shiki-dark:#d9739f\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            if</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> count</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> ==</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a13865;--shiki-dark:#d9739f\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">                break</span><span style=\"color:#999999;--shiki-dark:#666666\"> '</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">counting_up</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 退出名为 'counting_up 的外层循环</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">            </span><span style=\"color:#a13865;--shiki-dark:#d9739f\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">            remaining</span><span style=\"color:#999999;--shiki-dark:#666666\"> -=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        count</span><span style=\"color:#999999;--shiki-dark:#666666\"> +=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    println!</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">End count = </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">count</span><span style=\"color:#999999;--shiki-dark:#666666\">&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h4 id=\"while-循环\"><a class=\"anchor\" href=\"#while-循环\">#</a> <code>while</code> 循环</h4>\n<p>当条件为真时，循环就会继续。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> while_function</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    let</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> mut</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> number</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    while</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> number</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> !=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        println!</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">!</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> number</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        number</span><span style=\"color:#999999;--shiki-dark:#666666\"> -=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    println!</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">LIFTOFF!!!</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h4 id=\"for-循环\"><a class=\"anchor\" href=\"#for-循环\">#</a> <code>for</code> 循环</h4>\n<p>用于遍历集合中的每个元素，如数组。<code>for</code> 循环是更安全、更简洁的选择，因为它避免了 <code>while</code> 循环中可能出现的索引越界等错误。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-rust\"><span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fn</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> for_function</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    let</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> a</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">10</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 20</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 30</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 40</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 50</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 使用 .iter() 方法遍历集合</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    for</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> element</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> a</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">iter</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        println!</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">The value is: </span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> element</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 遍历一个范围 (Range)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // .rev() 方法用于反转范围</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    for</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> number</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">..</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">4</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rev</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        println!</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">&#123;&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">!</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> number</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    println!</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">LIFTOFF!!!</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n",
            "tags": [
                "Programing",
                "Rust"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/SBC/%E8%AE%BE%E7%BD%AEvim%E7%BC%96%E7%A0%81%E6%A0%BC%E5%BC%8F%E4%B8%BAutf-8/",
            "url": "https://haoruanwn.github.io/2025/07/28/SBC/%E8%AE%BE%E7%BD%AEvim%E7%BC%96%E7%A0%81%E6%A0%BC%E5%BC%8F%E4%B8%BAutf-8/",
            "title": "设置vim编码格式为utf-8",
            "date_published": "2025-07-28T13:47:38.000Z",
            "content_html": "<h4 id=\"配置-vim-实现永久解决\"><a class=\"anchor\" href=\"#配置-vim-实现永久解决\">#</a> 配置 Vim 实现永久解决</h4>\n<p>为了让 Vim 以后新建或打开文件时都默认使用 UTF-8，需要配置 Vim 的启动文件 <code>.vimrc</code>。</p>\n<ol>\n<li>\n<p><strong>回到您的终端</strong> (如果还在Vim里，先输入 <code>:q</code> 退出)。</p>\n</li>\n<li>\n<p><strong>编辑 Vim 配置文件</strong>。这个文件位于您的用户主目录下，名为 <code>.vimrc</code>。如果不存在，这个命令会自动创建它。</p>\n<p>Bash</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>vim ~/.vimrc</span></span></code></pre>\n</li>\n<li>\n<p><strong>在文件中加入以下配置</strong>：</p>\n<p>Vim Script</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>\" 设置Vim内部使用的编码为UTF-8</span></span>\n<span class=\"line\"><span>set encoding=utf-8</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>\" 设置Vim保存文件时使用的编码为UTF-8</span></span>\n<span class=\"line\"><span>set fileencoding=utf-8</span></span>\n<span class=\"line\"><span></span></span>\n<span class=\"line\"><span>\" 设置Vim与终端通信时使用的编码为UTF-8</span></span>\n<span class=\"line\"><span>set termencoding=utf-8</span></span></code></pre>\n<ul>\n<li><strong>提示</strong>：在 Vim 配置文件中，<code>&quot;</code> 开头的行是注释。</li>\n</ul>\n</li>\n<li>\n<p><strong>保存并退出</strong>。</p>\n<ul>\n<li>在 <code>nano</code> 中，按 <code>Ctrl+X</code>，然后按 <code>Y</code>，再按 <code>Enter</code>。</li>\n</ul>\n</li>\n</ol>\n",
            "tags": [
                "单板计算机/Linux开发板",
                "VIM"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/SBC/%E4%BD%BF%E7%94%A8chroot%E5%92%8CQEMU%E8%B0%83%E8%AF%95%E5%BC%80%E5%8F%91%E6%9D%BF%E7%B3%BB%E7%BB%9F/",
            "url": "https://haoruanwn.github.io/2025/07/28/SBC/%E4%BD%BF%E7%94%A8chroot%E5%92%8CQEMU%E8%B0%83%E8%AF%95%E5%BC%80%E5%8F%91%E6%9D%BF%E7%B3%BB%E7%BB%9F/",
            "title": "使用chroot和QEMU调试开发板系统",
            "date_published": "2025-07-28T13:46:47.000Z",
            "content_html": "<h1 id=\"使用-chroot-和-qemu-调试开发板系统\"><a class=\"anchor\" href=\"#使用-chroot-和-qemu-调试开发板系统\">#</a> 使用 <code>chroot</code> 和 QEMU 调试开发板系统</h1>\n<h2 id=\"一-chroot-与-qemu-简介\"><a class=\"anchor\" href=\"#一-chroot-与-qemu-简介\">#</a> 一、<code>chroot</code> 与 QEMU 简介</h2>\n<h3 id=\"chroot-change-root\"><a class=\"anchor\" href=\"#chroot-change-root\">#</a> <code>chroot</code> (Change Root)</h3>\n<p><code>chroot</code> 是 Linux 系统中的一个命令及系统调用，用于将一个进程及其子进程的根目录切换到文件系统中的一个新位置。这使得该进程无法访问或命名新根目录之外的文件。</p>\n<p><strong>主要用途：</strong></p>\n<ul>\n<li><strong>系统修复</strong>：当系统无法启动时，可以使用 Live CD 启动，然后 <code>chroot</code> 到损坏的系统中进行修复。</li>\n<li><strong>安全隔离</strong>：限制特定进程的文件系统访问权限，创建一个简易的沙箱环境。</li>\n<li><strong>交叉编译</strong>：在 x86 主机上为 ARM 等不同架构的设备构建和测试软件。</li>\n<li><strong>环境测试</strong>：在当前系统中模拟另一个 Linux 发行版环境，例如在 Ubuntu 中运行 Debian 环境。</li>\n</ul>\n<h3 id=\"qemu-user-static\"><a class=\"anchor\" href=\"#qemu-user-static\">#</a> <code>qemu-user-static</code></h3>\n<p>当在 x86 架构的主机上 <code>chroot</code> 到一个为 ARM 等异构平台构建的根文件系统时，会因为 CPU 指令集不兼容而导致无法执行任何程序。<code>qemu-user-static</code> 通过 <code>binfmt_misc</code> 机制解决了这个问题，它能够透明地解释和执行异构架构的二进制文件，从而在主机上模拟目标硬件环境。</p>\n<h2 id=\"二-操作流程\"><a class=\"anchor\" href=\"#二-操作流程\">#</a> 二、操作流程</h2>\n<h3 id=\"1-安装-qemu-user-static\"><a class=\"anchor\" href=\"#1-安装-qemu-user-static\">#</a> 1. 安装 <code>qemu-user-static</code></h3>\n<p>首先，在主机系统中安装 <code>qemu-user-static</code> 软件包。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> apt</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> apt</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> qemu-user-static</span></span></code></pre>\n<p>安装完成后，将对应目标架构的 QEMU 静态二进制文件复制到开发板根文件系统的 <code>usr/bin</code> 目录下。例如，对于 ARM 架构：</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 假设 \"ubuntu/\" 是开发板根文件系统的挂载点</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> cp</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /usr/bin/qemu-arm-static</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ubuntu/usr/bin/</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> cp</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /usr/bin/qemu-aarch64-static</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ubuntu/usr/bin/</span></span></code></pre>\n<p>为了确保 QEMU 能够自动处理异构架构的二进制文件，需要检查 <code>binfmt_misc</code> 的配置是否已启用。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ls</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -l</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /proc/sys/fs/binfmt_misc/</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 检查对应的 qemu-aarch64 解释器是否启用</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cat</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /proc/sys/fs/binfmt_misc/qemu-aarch64</span></span></code></pre>\n<p>理想情况下，<code>cat</code> 命令的输出应显示 <code>enabled</code>。</p>\n<p>手动注册qemu</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># rsicv64</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sh</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -c</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">echo \":qemu-riscv64:M::\\x7fELF\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\xf3\\x00:\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x00\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xfe\\xff\\xff\\xff:/usr/bin/qemu-riscv64-static:F\" > /proc/sys/fs/binfmt_misc/register</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># aarch64</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sh</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -c</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">echo \":qemu-aarch64:M::\\x7fELF\\x02\\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\xb7\\x00:\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\x00\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xff\\xfe\\xff\\xff\\xff:/usr/bin/qemu-aarch64-static:F\" > /proc/sys/fs/binfmt_misc/register</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span></span></code></pre>\n<h3 id=\"2-挂载根文件系统-rootfs\"><a class=\"anchor\" href=\"#2-挂载根文件系统-rootfs\">#</a> 2. 挂载根文件系统 (rootfs)</h3>\n<p>为了方便地挂载和卸载 <code>chroot</code> 环境所需的虚拟文件系统，可以创建一个脚本。</p>\n<p><strong>创建 <code>mount.sh</code> 脚本：</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#!/bin/bash</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># mount.sh - Mounts/unmounts essential filesystems for chroot</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">function</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> mnt</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    echo</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">MOUNTING...</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mount</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> proc</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /proc</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">proc</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mount</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -t</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sysfs</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /sys</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">sys</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mount</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -o</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bind</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /dev</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">dev</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mount</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -o</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bind</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /dev/pts</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">dev/pts</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    echo</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Entering chroot environment...</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> chroot</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">function</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> umnt</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    echo</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">UNMOUNTING...</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> umount</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">proc</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> umount</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">sys</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> umount</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">dev/pts</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> umount</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">dev</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">$1</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> ==</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">-m</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -n</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">$2</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> then</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    mnt</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $1</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $2</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">elif</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">$1</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> ==</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">-u</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#999999;--shiki-dark:#666666\"> &#x26;&#x26;</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -n</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">$2</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> then</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    umnt</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $1</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $2</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">else</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    echo</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Usage: $0 [-m|-u] &#x3C;rootfs_path></span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    echo</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  -m: Mount and chroot into the rootfs</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    echo</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">  -u: Unmount the rootfs</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    echo</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Example: $0 -m /path/to/rootfs/</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fi</span></span></code></pre>\n<p><strong>赋予脚本执行权限：</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">chmod</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> +x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mount.sh</span></span></code></pre>\n<p>python脚本</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#!/usr/bin/env python3</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># -*- coding: utf-8 -*-</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sys</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> subprocess</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">import</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> shutil</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># --- 用户配置 ---</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># !!! 请在这里修改为您要挂载的根文件系统的绝对路径 !!!</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">ROOTFS_PATH</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">/home/hao/k230_sdk/output/k230_canmv_lckfb_defconfig/images/debian13</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># !!! (可选) 如果您需要跨架构 chroot (例如在 x86 电脑上 chroot ARM 系统),</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 请指定 QEMU 静态二进制文件的路径。如果不需要，请留空 \"\"。</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 通常在 /usr/bin/ 目录下, 例如 qemu-aarch64-static, qemu-arm-static 等。</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">QEMU_STATIC_BINARY</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">/usr/bin/qemu-riscv64-static</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># --- 配置结束 ---</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> run_command</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#998418;--shiki-dark:#B8A965\">command</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> check=True</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    \"\"\"执行一个 shell 命令并处理可能发生的错误\"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"🚀 执行: &#123;' '.join(command)&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    try:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        subprocess.run</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">command,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> check=check</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    except</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> FileNotFoundError:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"❌ 命令未找到: &#123;command[0]&#125;。请确保该程序已安装并在 PATH 环境变量中。\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        sys.exit</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    except</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> subprocess.CalledProcessError</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> e:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"❌ 命令执行失败: &#123;' '.join(e.cmd)&#125; (返回码: &#123;e.returncode&#125;)\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> not</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> check:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">             print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   (警告: 此命令失败，但程序将继续执行)\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        else:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            sys.exit</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">1</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> unmount_filesystems</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    \"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    按正确顺序卸载所有 chroot 文件系统。</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    该函数设计得非常健壮，会检查每个挂载点是否存在且已挂载。</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    \"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    print</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"\\n🧹 开始安全卸载程序...\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    mount_points</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">dev/pts</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">dev</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">sys</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">proc</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    for</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> mp</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> in</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mount_points:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        target_path</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.join</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">ROOTFS_PATH,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mp</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> os.path.exists</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">target_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> and os.path.ismount</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">target_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            run_command</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'sudo'</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">umount</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">-l</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> target_path],</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> check=False</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 使用 -l (lazy) 更安全</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> QEMU_STATIC_BINARY:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        qemu_dest_path</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.join</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">ROOTFS_PATH,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">usr</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">bin</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.basename</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">QEMU_STATIC_BINARY</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> os.path.exists</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">qemu_dest_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">            print</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   清理 QEMU 模拟器: &#123;qemu_dest_path&#125;\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            run_command</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'sudo'</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">rm</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> qemu_dest_path]</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">    print</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"✅ 清理完成。\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mount_and_chroot</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    \"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    挂载所需的文件系统并进入 chroot 环境。</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    使用 try...finally 确保无论 chroot 内部发生什么，都会执行卸载。</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    \"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    try:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"🛠️  开始挂载 chroot 所需的文件系统...\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        mounts</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">[</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">            </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'proc'</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">proc</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">proc</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> None</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">            </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'sysfs'</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">sys</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">sysfs</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> None</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">            </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'/dev'</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">dev</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> None,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">bind</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">            </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'/dev/pts'</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">dev/pts</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> None,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">bind</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">]</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        for</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> source, dest_subdir, fstype, options in mounts:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            target_path</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.join</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">ROOTFS_PATH,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dest_subdir</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> not</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.exists</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">target_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">                print</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   创建缺失的目录: &#123;target_path&#125;\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                run_command</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'sudo'</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">mkdir</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">-p</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> target_path]</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">            command</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">sudo</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">mount</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">]</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> fstype:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> command.extend</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">-t</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, fstype</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">]</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> options</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ==</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">bind</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> command.extend</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">-o</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">bind</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">]</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">            command</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">.extend</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">[</span><span style=\"color:#998418;--shiki-dark:#B8A965\">source</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> target_path]</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            run_command</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">command</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> QEMU_STATIC_BINARY:</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> not</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.exists</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">QEMU_STATIC_BINARY</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">                print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"❌ 错误: QEMU 模拟器 '&#123;QEMU_STATIC_BINARY&#125;' 未在您的主机上找到。\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">                print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   如果您正在进行跨架构 chroot，请安装它 (例如: 'sudo apt install qemu-user-static')。\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">                return</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">            ### --- 新增功能：检查 binfmt_misc 是否启用 --- ###</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">            # 从 QEMU 二进制文件名推断出 binfmt_misc 的处理器名</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">            # 例如 \"qemu-aarch64-static\" -> \"qemu-aarch64\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            handler_name</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.basename</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">QEMU_STATIC_BINARY</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">.removesuffix</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'-static'</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            binfmt_path</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> f</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">/proc/sys/fs/binfmt_misc/&#123;handler_name&#125;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">            </span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">            print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   检查 QEMU binfmt_misc 处理器: &#123;binfmt_path&#125;\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> not</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.exists</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">binfmt_path</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">                print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"❌ 错误: QEMU binfmt_misc 处理器未启用 (&#123;binfmt_path&#125; 不存在)。\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">                print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   这意味着您的主机内核可能无法直接运行目标架构的二进制文件。\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">                print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   请尝试通过重启服务来注册处理器，例如运行:\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">                print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"     sudo systemctl restart systemd-binfmt.service\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">                print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   或者:\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">                print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"     sudo update-binfmts --enable\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">                return</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> # 提前中止，finally 块会负责清理</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">            </span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">            print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   ✅ QEMU binfmt_misc 处理器已启用。\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">            ### --- 新增功能结束 --- ###</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            qemu_dest_path</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.join</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">ROOTFS_PATH,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">usr</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">bin</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.basename</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">QEMU_STATIC_BINARY</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">            print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   复制 QEMU 模拟器到 chroot 环境: &#123;qemu_dest_path&#125;\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            run_command</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'sudo'</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">cp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> QEMU_STATIC_BINARY,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> qemu_dest_path]</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"\\n✅ 挂载完成。即将进入 chroot 环境...\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   在 chroot 环境中，您可以执行所需命令。\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"   完成后，请键入 'exit' 以退出 chroot 并自动卸载所有文件系统。\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        </span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        run_command</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">'sudo'</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">chroot</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ROOTFS_PATH]</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    except</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Exception</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> as</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> e:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"\\n❌ 在挂载或 chroot 过程中发生意外错误: &#123;e&#125;\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    finally:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"\\n🚪 已退出 chroot 环境或发生错误。\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        unmount_filesystems</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">def</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> main</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    \"\"\"脚本主入口\"\"\"</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> os.geteuid</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> !</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">=</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 0:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"❌ 错误: 此脚本需要 root 权限。请使用 'sudo' 运行。\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        sys.exit</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">1</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> not</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> os.path.isdir</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">ROOTFS_PATH</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"❌ 错误: 配置的根文件系统路径 '&#123;ROOTFS_PATH&#125;' 不是一个有效的目录。\"</span><span style=\"color:#59873A;--shiki-dark:#80A665\">,</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> file=sys.stderr</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        sys.exit</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">1</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> len</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">sys.argv</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">!</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> or</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sys.argv[1]</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> not</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> in</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:rgba(255, 18, 18, 0.8);--shiki-dark:rgba(255, 18, 18, 0.8)\">[</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">-m</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">, </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">-u</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">]:</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">f</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"用法: sudo &#123;sys.argv[0]&#125; [-m|-u]\"</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"  -m: 挂载文件系统并进入 chroot 环境\"</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">        print</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">\"  -u: 仅卸载文件系统 (用于手动清理)\"</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        sys.exit</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">1</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    action</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> =</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sys.argv[1]</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> action</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ==</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">-m</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        mount_and_chroot</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    elif</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> action</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ==</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">-u</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        unmount_filesystems</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">if</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> __name__</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ==</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> '</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">__main__</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">'</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">:</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    main</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span></span></code></pre>\n<p>使用方式</p>\n<ol>\n<li>\n<p><strong>配置</strong>：打开 <code>manage_chroot.py</code> 文件，修改顶部的 <code>ROOTFS_PATH</code> 变量，使其指向你的根文件系统目录（例如 <code>/home/user/my_project/rootfs</code>）。如果需要，同时配置 <code>QEMU_STATIC_BINARY</code>。</p>\n</li>\n<li>\n<p><strong>挂载并进入 Chroot</strong>： 在终端中运行以下命令。脚本将挂载所有必要的文件系统，然后自动带你进入 <code>chroot</code> 环境。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> python3</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> manage_chroot.py</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -m</span></span></code></pre>\n<p>当你完成在 <code>chroot</code> 环境中的工作后，只需输入 <code>exit</code> 并按回车。脚本会自动检测到退出，并执行所有卸载和清理操作。</p>\n</li>\n<li>\n<p><strong>仅执行卸载</strong>： 如果在某些异常情况下，你需要手动执行清理，可以运行以下命令。它会安全地卸载所有相关的挂载点。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> python3</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> manage_chroot.py</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -u</span></span></code></pre>\n</li>\n</ol>\n<h3 id=\"3-进入-chroot-环境并进行系统配置\"><a class=\"anchor\" href=\"#3-进入-chroot-环境并进行系统配置\">#</a> 3. 进入 <code>chroot</code> 环境并进行系统配置</h3>\n<p>使用上一步创建的脚本挂载并进入开发板的根文件系统。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 假设开发板根文件系统位于当前目录下的 \"ubuntu/\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ./mount.sh</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -m</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ubuntu/</span></span></code></pre>\n<p>成功进入后，你将处于开发板的模拟环境中，可以执行系统配置任务。</p>\n<h4 id=\"a-更新软件源及安装必要软件\"><a class=\"anchor\" href=\"#a-更新软件源及安装必要软件\">#</a> a. 更新软件源及安装必要软件</h4>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 某些系统可能需要赋予/tmp目录写权限</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">chmod</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 777</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /tmp</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">apt</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> update</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">apt</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -y</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> vim</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> udev</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> net-tools</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ethtool</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> udhcpc</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> netplan.io</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">               language-pack-en-base</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> iputils-ping</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> openssh-sftp-server</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">               ntp</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> usbutils</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> alsa-utils</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> libmtp9</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> language-pack-zh-han</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">*</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">               bluetooth</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">*</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> bluez</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">*</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> blueman</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">*</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> wireless-tools</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> network-manager</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> dialog</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 清理不需要的软件包</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">apt-get</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> remove</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> --purge</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> libreoffice</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">*</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -y</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">apt-get</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> autoremove</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -y</span></span></code></pre>\n<h4 id=\"b-添加用户及配置权限\"><a class=\"anchor\" href=\"#b-添加用户及配置权限\">#</a> b. 添加用户及配置权限</h4>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 1. 添加一个新用户（例如 tspi）</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">adduser</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> tspi</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 2. 将新用户添加到 sudo 组以赋予管理员权限</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">adduser</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> tspi</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sudo</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 3. 修改 root 用户的密码</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">passwd</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> root</span></span></code></pre>\n<h4 id=\"c-优化开机网络等待时间\"><a class=\"anchor\" href=\"#c-优化开机网络等待时间\">#</a> c. 优化开机网络等待时间</h4>\n<p>默认情况下，系统启动时可能会等待网络配置长达5分钟。通过修改 systemd 服务，可以缩短或禁用此等待时间。</p>\n<p><strong>编辑服务文件：</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">vim</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /etc/systemd/system/network-online.target.wants/systemd-networkd-wait-online.service</span></span></code></pre>\n<p><strong>修改 <code>ExecStart</code> 行：</strong><br />\n将 <code>timeout</code> 参数改为一个较小的值（如 5 秒）或 <code>0</code>（禁用）。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-ini\"><span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Service</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">ExecStart</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/usr/bin/nm-online -s -q --</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">timeout</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">5</span></span></code></pre>\n<h4 id=\"d-添加分区自动扩容服务重要\"><a class=\"anchor\" href=\"#d-添加分区自动扩容服务重要\">#</a> d. 添加分区自动扩容服务（重要）</h4>\n<p>为了让烧录到 SD 卡或 eMMC 的文件系统在首次启动时自动扩展以使用整个分区空间，可以创建一个系统服务。</p>\n<p><strong>(1) 创建 <code>resize2fs.sh</code> 脚本：</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">vim</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /etc/init.d/resize2fs.sh</span></span></code></pre>\n<p><strong>添加以下内容：</strong><br />\n该脚本会检查一个标志文件，如果不存在，则执行分区扩容并创建该标志文件，确保扩容只执行一次。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#!/bin/bash -e</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># Resize the root filesystem partition, e.g., /dev/mmcblk0p6</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">PARTITION_TO_RESIZE</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">/dev/mmcblk0p6</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">FLAG_FILE</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">/usr/local/boot_flag</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> !</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -e</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">$FLAG_FILE</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#999999;--shiki-dark:#666666\"> ;</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> then</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">  echo</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Resizing $PARTITION_TO_RESIZE...</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  resize2fs</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> $PARTITION_TO_RESIZE</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">  touch</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">$FLAG_FILE</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">  echo</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Resize complete.</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">fi</span></span></code></pre>\n<p><strong>(2) 赋予脚本执行权限：</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">chmod</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> +x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /etc/init.d/resize2fs.sh</span></span></code></pre>\n<p><strong>(3) 创建 systemd 服务来执行此脚本：</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">vim</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /lib/systemd/system/resize2fs.service</span></span></code></pre>\n<p><strong>添加服务定义：</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-ini\"><span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Unit</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">Description</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Resize root filesystem on first boot</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">DefaultDependencies</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">no</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">After</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">systemd-remount-fs.service</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">Before</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">local-fs.target</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Service</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">Type</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">oneshot</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">ExecStart</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/etc/init.d/resize2fs.sh</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">StandardOutput</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">journal</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">RemainAfterExit</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">yes</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Install</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">WantedBy</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">multi-user.target</span></span></code></pre>\n<p><strong>(4) 启用该服务：</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">systemctl</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> enable</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> resize2fs.service</span></span></code></pre>\n<h3 id=\"4-退出并卸载根文件系统\"><a class=\"anchor\" href=\"#4-退出并卸载根文件系统\">#</a> 4. 退出并卸载根文件系统</h3>\n<p>完成所有配置后，退出 <code>chroot</code> 环境。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#998418;--shiki-dark:#B8A965\">exit</span></span></code></pre>\n<p>返回到主机系统后，使用脚本卸载之前挂载的虚拟文件系统。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ./mount.sh</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -u</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ubuntu/</span></span></code></pre>\n",
            "tags": [
                "单板计算机/Linux开发板",
                "rootfs"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/SBC/NTP%E4%B8%8E%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E8%AE%BE%E7%BD%AE/",
            "url": "https://haoruanwn.github.io/2025/07/28/SBC/NTP%E4%B8%8E%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E8%AE%BE%E7%BD%AE/",
            "title": "NTP与系统时间设置",
            "date_published": "2025-07-28T13:45:22.000Z",
            "content_html": "<h2 id=\"一-安装基础服务\"><a class=\"anchor\" href=\"#一-安装基础服务\">#</a> 一、安装基础服务</h2>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> apt</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> install</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> systemd-timesyncd</span></span></code></pre>\n<h4 id=\"如果因为系统时间问题导致apt源不可用\"><a class=\"anchor\" href=\"#如果因为系统时间问题导致apt源不可用\">#</a> 如果因为系统时间问题导致apt源不可用</h4>\n<p>手动设置时间</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> date</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> -s</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">2025-06-26 00:26:00</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> # 设置为当前时间</span></span></code></pre>\n<h2 id=\"二-修改ntp服务器地址\"><a class=\"anchor\" href=\"#二-修改ntp服务器地址\">#</a> 二、修改NTP服务器地址</h2>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> vim</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /etc/systemd/timesyncd.conf</span></span></code></pre>\n<p>添加NTP服务器</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-ini\"><span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Time</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">NTP</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">ntp.aliyun.com ntp1.aliyun.com ntp2.aliyun.com</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#FallbackNTP=ntp.ubuntu.com</span></span></code></pre>\n<p>重启服务</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> restart</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> systemd-timesyncd</span></span></code></pre>\n<p>检查状态</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">timedatectl</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> status</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 理想输出</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">tspi@localhost:~$</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> timedatectl</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> status</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">               Local</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> time:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Thu</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 2025-06-26</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 00:29:05</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> CST</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">           Universal</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> time:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Wed</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 2025-06-25</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 16:29:05</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> UTC</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                 RTC</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> time:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Wed</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 2025-06-25</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 16:29:06</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                Time</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> zone:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> Asia/Shanghai</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">CST, </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">+0800</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">System</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> clock</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> synchronized:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> yes</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">              NTP</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> service:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> active</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">          RTC</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> in</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> local</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> TZ:</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> no</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">tspi@localhost:~$</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> apt</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> update</span></span></code></pre>\n",
            "tags": [
                "单板计算机/Linux开发板",
                "系统配置"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/SBC/systemd%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF/",
            "url": "https://haoruanwn.github.io/2025/07/28/SBC/systemd%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF/",
            "title": "systemd设置开机自启",
            "date_published": "2025-07-28T13:43:52.000Z",
            "content_html": "<h3 id=\"ubuntudebian-使用-systemd-设置开机自启服务快速指南\"><a class=\"anchor\" href=\"#ubuntudebian-使用-systemd-设置开机自启服务快速指南\">#</a> <strong>Ubuntu/Debian 使用 <code>systemd</code> 设置开机自启服务快速指南</strong></h3>\n<p>本文档提供了在基于 <code>systemd</code> 的现代 Linux 系统（如 Ubuntu, Debian 等）上创建和管理开机自启服务的标准流程。</p>\n<h4 id=\"第1步准备您的脚本\"><a class=\"anchor\" href=\"#第1步准备您的脚本\">#</a> <strong>第1步：准备您的脚本</strong></h4>\n<p>确保您的脚本可以被系统直接执行。</p>\n<ol>\n<li>\n<p>指定解释器 (Shebang)</p>\n<p>在脚本文件的第一行，指明用于执行它的程序。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">#!/usr/bin/env python3 </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 或者 #!/bin/bash</span></span></code></pre>\n</li>\n<li>\n<p>放置在标准位置</p>\n<p>将脚本移动到系统的可执行路径下，推荐使用 /usr/local/bin。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> mv</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> your_script.py</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /usr/local/bin/</span></span></code></pre>\n</li>\n<li>\n<p>赋予执行权限</p>\n<p>使脚本文件变为可执行。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> chmod</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> +x</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /usr/local/bin/your_script.py</span></span></code></pre>\n</li>\n</ol>\n<hr />\n<h4 id=\"第2步创建-systemd-服务文件\"><a class=\"anchor\" href=\"#第2步创建-systemd-服务文件\">#</a> <strong>第2步：创建 <code>systemd</code> 服务文件</strong></h4>\n<p>创建一个服务单元文件来告诉 <code>systemd</code> 如何管理您的脚本。</p>\n<ol>\n<li>\n<p>创建 .service 文件</p>\n<p>在 /etc/systemd/system/ 目录下创建一个以 .service 结尾的新文件。文件名将作为您的服务名。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nano</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> /etc/systemd/system/myservice.service</span></span></code></pre>\n</li>\n<li>\n<p>填入模板内容</p>\n<p>将以下模板粘贴到文件中，并根据您的需求修改 Description 和 ExecStart 字段。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-ini\"><span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Unit</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 对服务的简短描述</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">Description</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">My Custom Startup Service</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 指定服务在网络准备好之后启动</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">After</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">network.target</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Service</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 指定要执行的脚本的完整路径</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">ExecStart</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/usr/local/bin/your_script.py</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 定义服务失败后总是自动重启</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">Restart</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">always</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Install</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 指定服务在多用户模式下启用</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">WantedBy</span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">multi-user.target</span></span></code></pre>\n</li>\n</ol>\n<hr />\n<h4 id=\"第3步管理服务\"><a class=\"anchor\" href=\"#第3步管理服务\">#</a> <strong>第3步：管理服务</strong></h4>\n<p>使用 <code>systemctl</code> 命令来控制您的新服务。</p>\n<ol>\n<li>\n<p>重新加载配置</p>\n<p>在创建或修改服务文件后，必须运行此命令来让 systemd 读取新的配置。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> daemon-reload</span></span></code></pre>\n</li>\n<li>\n<p>启用服务</p>\n<p>将服务设置为开机自启。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> enable</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> myservice.service</span></span></code></pre>\n</li>\n<li>\n<p>立即启动服务</p>\n<p>无需重启，立即运行您的服务以进行测试。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> start</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> myservice.service</span></span></code></pre>\n</li>\n<li>\n<p>检查服务状态</p>\n<p>查看服务是否正在运行，以及查看最新的日志输出，这是调试的关键。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> systemctl</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> status</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> myservice.service</span></span></code></pre>\n</li>\n</ol>\n<hr />\n<h3 id=\"常用命令备忘\"><a class=\"anchor\" href=\"#常用命令备忘\">#</a> <strong>常用命令备忘</strong></h3>\n<ul>\n<li><strong>启用开机自启</strong>： <code>sudo systemctl enable myservice.service</code></li>\n<li><strong>禁止开机自启</strong>： <code>sudo systemctl disable myservice.service</code></li>\n<li><strong>启动服务</strong>： <code>sudo systemctl start myservice.service</code></li>\n<li><strong>停止服务</strong>： <code>sudo systemctl stop myservice.service</code></li>\n<li><strong>重启服务</strong>： <code>sudo systemctl restart myservice.service</code></li>\n<li><strong>查看状态和日志</strong>：<code>sudo systemctl status myservice.service</code></li>\n<li><strong>查看完整日志</strong>： <code>sudo journalctl -u myservice.service</code></li>\n</ul>\n",
            "tags": [
                "单板计算机/Linux开发板",
                "系统配置"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/SBC/%E5%BC%80%E5%8F%91%E6%9D%BF%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/",
            "url": "https://haoruanwn.github.io/2025/07/28/SBC/%E5%BC%80%E5%8F%91%E6%9D%BF%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/",
            "title": "开发板网络配置",
            "date_published": "2025-07-28T13:43:22.000Z",
            "content_html": "<h1 id=\"使用-nmcli-管理网络连接\"><a class=\"anchor\" href=\"#使用-nmcli-管理网络连接\">#</a> 使用 <code>nmcli</code> 管理网络连接</h1>\n<p><code>nmcli</code> 是 NetworkManager 的命令行客户端，是在现代 Linux 发行版（如 Debian、Ubuntu、CentOS）中管理网络连接的强大工具。</p>\n<h2 id=\"一-wifi-配置\"><a class=\"anchor\" href=\"#一-wifi-配置\">#</a> 一、WiFi 配置</h2>\n<h3 id=\"1-查看网络设备\"><a class=\"anchor\" href=\"#1-查看网络设备\">#</a> 1. 查看网络设备</h3>\n<p>首先，使用 <code>nmcli device status</code> 查看系统中所有网络设备及其状态，以确定无线网卡的名称（通常为 <code>wlan0</code>）。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> status</span></span></code></pre>\n<h3 id=\"2-扫描-wifi-网络\"><a class=\"anchor\" href=\"#2-扫描-wifi-网络\">#</a> 2. 扫描 WiFi 网络</h3>\n<p>使用以下命令扫描并列出周围可用的 WiFi 网络。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> wifi</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> list</span></span></code></pre>\n<h3 id=\"3-连接-断开与删除-wifi\"><a class=\"anchor\" href=\"#3-连接-断开与删除-wifi\">#</a> 3. 连接、断开与删除 WiFi</h3>\n<h4 id=\"连接到-wifi\"><a class=\"anchor\" href=\"#连接到-wifi\">#</a> 连接到 WiFi</h4>\n<p>使用 <code>connect</code> 命令连接到指定的 WiFi 网络 (SSID)。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 格式: sudo nmcli device wifi connect &#x3C;SSID> password &#x3C;密码></span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> wifi</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connect</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 503</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> password</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 503503503</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> wifi</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connect</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 虚空终端</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> password</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 503503503</span></span></code></pre>\n<p>连接成功后，NetworkManager 会自动创建一个连接配置文件。</p>\n<p>设置为开机自动连接</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> modify</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 503</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection.autoconnect</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> yes</span></span></code></pre>\n<h4 id=\"管理连接配置\"><a class=\"anchor\" href=\"#管理连接配置\">#</a> 管理连接配置</h4>\n<p>可以查看、修改、断开或删除已保存的连接配置。</p>\n<table>\n<thead>\n<tr>\n<th><strong>操作</strong></th>\n<th><strong>命令</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>查看所有配置</strong></td>\n<td><code>nmcli connection show</code></td>\n<td>列出所有已保存的网络连接配置。</td>\n</tr>\n<tr>\n<td><strong>设置自动连接</strong></td>\n<td><code>sudo nmcli connection modify &lt;名称&gt; connection.autoconnect yes</code></td>\n<td>将指定连接设置为开机自动连接。</td>\n</tr>\n<tr>\n<td><strong>断开连接</strong></td>\n<td><code>nmcli device disconnect &lt;网卡名称&gt;</code></td>\n<td>临时断开指定网卡的当前连接。</td>\n</tr>\n<tr>\n<td><strong>删除配置</strong></td>\n<td><code>sudo nmcli connection delete &lt;名称&gt;</code></td>\n<td>永久删除指定名称的连接配置文件。</td>\n</tr>\n</tbody>\n</table>\n<p><strong>示例：</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 查看所有连接配置，找到要操作的连接名称</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> show</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 设置名为 \"503\" 的 WiFi 连接开机自启</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> modify</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 503</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection.autoconnect</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> yes</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 断开 wlan0 网卡的连接</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> device</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> disconnect</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> wlan0</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 删除名为 \"虚空终端\" 的 WiFi 配置</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> delete</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 虚空终端</span></span></code></pre>\n<h2 id=\"二-设置静态-ip-地址\"><a class=\"anchor\" href=\"#二-设置静态-ip-地址\">#</a> 二、设置静态 IP 地址</h2>\n<p>在某些场景下（如将设备用作服务器或通过旁路由上网），需要将动态 IP (DHCP) 修改为静态 IP。</p>\n<h3 id=\"1-确定要修改的连接\"><a class=\"anchor\" href=\"#1-确定要修改的连接\">#</a> 1. 确定要修改的连接</h3>\n<p>首先，使用 <code>nmcli connection show</code> 找到需要修改的连接配置的名称 (<code>NAME</code>)。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> show</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 示例输出</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># NAME                UUID                                  TYPE      DEVICE </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 503                 82cbca27-7035-420a-96c0-f54aef5c5f83  wifi      wlan0  </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># Wired connection 1  xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx  ethernet  eth0</span></span></code></pre>\n<h3 id=\"2-修改连接为静态-ip\"><a class=\"anchor\" href=\"#2-修改连接为静态-ip\">#</a> 2. 修改连接为静态 IP</h3>\n<p>使用 <code>nmcli connection modify</code> 命令修改指定连接的网络参数。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 语法示例</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> modify</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">&#x3C;连接名称></span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">    ipv4.method</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> manual</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">    ipv4.addresses</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">IP地</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">址</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">/</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">子网掩码前</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">缀</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">    ipv4.gateway</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">网关地</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">址</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">    ipv4.dns</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">&#x3C;DNS服务器1>,&#x3C;DNS服务器2></span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 实际示例：将名为 \"503\" 的连接修改为静态IP</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> modify</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">503</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">    ipv4.method</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> manual</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">    ipv4.addresses</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> 192.168.31.152/24</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">    ipv4.gateway</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 192.168.31.141</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\"> \\</span></span>\n<span class=\"line\"><span style=\"color:#B56959;--shiki-dark:#C98A7D\">    ipv4.dns</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">223.5.5.5,114.114.114.114</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<table>\n<thead>\n<tr>\n<th><strong>参数</strong></th>\n<th><strong>说明</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>ipv4.method</code></td>\n<td><code>manual</code> 表示静态 IP，<code>auto</code> 表示 DHCP。</td>\n</tr>\n<tr>\n<td><code>ipv4.addresses</code></td>\n<td>设置静态 IP 地址和子网掩码（使用 CIDR 表示法）。</td>\n</tr>\n<tr>\n<td><code>ipv4.gateway</code></td>\n<td>设置默认网关地址。</td>\n</tr>\n<tr>\n<td><code>ipv4.dns</code></td>\n<td>设置 DNS 服务器，多个服务器用逗号分隔。</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"3-应用更改\"><a class=\"anchor\" href=\"#3-应用更改\">#</a> 3. 应用更改</h3>\n<p>修改配置后，需要重新激活连接以使设置生效。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-text\"><span class=\"line\"><span>sudo nmcli connection down \"503\" &#x26;&#x26; sudo nmcli connection up \"503\"</span></span></code></pre>\n<h3 id=\"4-恢复为-dhcp\"><a class=\"anchor\" href=\"#4-恢复为-dhcp\">#</a> 4. 恢复为 DHCP</h3>\n<p>如果需要从静态 IP 切换回动态 IP (DHCP)，只需将 <code>ipv4.method</code> 修改为 <code>auto</code> 并重连即可。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-bash\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> modify</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">503</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ipv4.method</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> auto</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 清空静态配置（可选但推荐）</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> modify</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">503</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ipv4.addresses</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ipv4.gateway</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> ipv4.dns</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"\"</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 重启连接</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">sudo</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> nmcli</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> connection</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> up</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">503</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span></code></pre>\n<h2 id=\"三-无线网络测试\"><a class=\"anchor\" href=\"#三-无线网络测试\">#</a> 三、无线网络测试</h2>\n<p>配置完成后，可以使用以下工具测试网络连通性。</p>\n<table>\n<thead>\n<tr>\n<th><strong>命令</strong></th>\n<th><strong>用途</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>ping</code></td>\n<td>测试与目标主机（IP或域名）的基本连通性和延迟。 <code>ping 8.8.8.8</code></td>\n</tr>\n<tr>\n<td><code>ip addr</code></td>\n<td>查看网络接口的 IP 地址、MAC 地址等详细信息。</td>\n</tr>\n<tr>\n<td><code>iwconfig</code></td>\n<td>（旧工具）查看无线网卡的连接状态，如 SSID、信号强度 (Link Quality)、比特率 (Bit Rate) 等。</td>\n</tr>\n</tbody>\n</table>\n",
            "tags": [
                "单板计算机/Linux开发板",
                "网络"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/OpenCV/opencv%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BAwindows/",
            "url": "https://haoruanwn.github.io/2025/07/28/OpenCV/opencv%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BAwindows/",
            "title": "opencv环境搭建windows",
            "date_published": "2025-07-28T13:39:04.000Z",
            "content_html": "<h1 id=\"说明\"><a class=\"anchor\" href=\"#说明\">#</a> 说明</h1>\n<p>Windows平台，使用CMake构建，Clion开发。官网下载的OpenCV是使用MSVC编译的，所以工具链需要配置为MSVC，否则会有ABI不兼容的问题。如果要用MinGW的话需要从源码编译一遍OpenCV。</p>\n<h1 id=\"流程\"><a class=\"anchor\" href=\"#流程\">#</a> 流程</h1>\n<h2 id=\"一-设置环境变量\"><a class=\"anchor\" href=\"#一-设置环境变量\">#</a> 一、设置环境变量</h2>\n<h4 id=\"添加系统变量opencv_dir\"><a class=\"anchor\" href=\"#添加系统变量opencv_dir\">#</a> 添加系统变量<code>OpenCV_DIR</code></h4>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/202506171515987.png\" alt=\"QQ20250617-151450\" /></p>\n<h4 id=\"添加环境变量\"><a class=\"anchor\" href=\"#添加环境变量\">#</a> 添加环境变量</h4>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/202506171515202.png\" alt=\"QQ20250617-151514\" /></p>\n<p><strong>配置好后需要重启电脑</strong></p>\n<h2 id=\"二-设置clion工具链和cmake配置\"><a class=\"anchor\" href=\"#二-设置clion工具链和cmake配置\">#</a> 二、设置Clion工具链和CMake配置</h2>\n<h4 id=\"工具链配置\"><a class=\"anchor\" href=\"#工具链配置\">#</a> 工具链配置</h4>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/202506171517203.png\" alt=\"QQ20250617-151714\" /></p>\n<h4 id=\"cmake配置\"><a class=\"anchor\" href=\"#cmake配置\">#</a> CMake配置</h4>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/202506171518178.png\" alt=\"QQ20250617-151739\" /></p>\n<h2 id=\"三-cmakeliststxt编写\"><a class=\"anchor\" href=\"#三-cmakeliststxt编写\">#</a> 三、CMakeLists.txt编写</h2>\n<p>参考</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cmake\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 1. 设置CMake最低版本要求和项目信息</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">cmake_minimum_required</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">VERSION</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> 3.10</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 定义项目名称和版本</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">project</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">MyOpenCVProject </span><span style=\"color:#59873A;--shiki-dark:#80A665\">VERSION</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> 1.0</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 2. 设置C++标准</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 推荐使用C++11或更高版本</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">CMAKE_CXX_STANDARD 20</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">CMAKE_CXX_STANDARD_REQUIRED </span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">True</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 3. 查找OpenCV库</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># REQUIRED 参数表示如果找不到OpenCV，CMake会报错并停止构建</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># COMPONENTS 参数指定你需要使用的OpenCV模块，可以减少最终程序的体积</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 常见的模块有：core, highgui, imgcodecs, imgproc, videoio, objdetect等</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">find_package</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">OpenCV REQUIRED COMPONENTS core highgui imgproc</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 检查是否成功找到OpenCV</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">if</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">OpenCV_FOUND</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"OpenCV found: $&#123;OpenCV_LIBS&#125;\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">else</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">FATAL_ERROR </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"OpenCV not found\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">endif</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 4. 包含OpenCV的头文件目录</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 这使得你可以在代码中使用 #include &#x3C;opencv2/core.hpp> 等</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include_directories</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">OpenCV_INCLUDE_DIRS</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 5. 添加源文件并生成可执行文件</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 将你的C++源文件（例如 main.cpp）添加到这里</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># $&#123;PROJECT_NAME&#125; 会被替换为上面定义的 \"MyOpenCVProject\"</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">add_executable</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> main.cpp</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 6. 链接OpenCV库</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 将你的可执行文件与找到的OpenCV库链接起来</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># $&#123;OpenCV_LIBS&#125; 是一个由find_package创建的变量，包含了所有需要的库文件路径</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">target_link_libraries</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">$</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_NAME</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">OpenCV_LIBS</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 7. (可选) 为Windows平台设置输出目录</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"># 这段代码可以让你生成的.exe文件和.dll文件都在同一个目录下，方便运行</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">if</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">WIN32</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">EXECUTABLE_OUTPUT_PATH</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_BINARY_DIR</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/bin</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    set</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">LIBRARY_OUTPUT_PATH</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> $</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">PROJECT_BINARY_DIR</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">/bin</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    # 在Debug模式下，输出调试信息</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">CMAKE_BUILD_TYPE</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> STREQUAL</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\"> \"Debug\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        message</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">STATUS </span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">\"Build type: Debug\"</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    endif</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">endif</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span></span></code></pre>\n",
            "tags": [
                "OpenCV"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/OpenCV/opencv%E6%96%87%E4%BB%B6%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/",
            "url": "https://haoruanwn.github.io/2025/07/28/OpenCV/opencv%E6%96%87%E4%BB%B6%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/",
            "title": "opencv文件输入输出",
            "date_published": "2025-07-28T13:38:45.000Z",
            "content_html": "<h2 id=\"一-图像的读取与显示\"><a class=\"anchor\" href=\"#一-图像的读取与显示\">#</a> 一、图像的读取与显示</h2>\n<p>核心功能是使用 <code>cv::imread()</code> 函数读取图像数据，并将其存储在一个 <code>cv::Mat</code> 对象中，然后通过 <code>cv::imshow()</code> 函数将图像显示在窗口中。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">iostream</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 1. 指定图像路径</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 注意：在Windows上，路径分隔符应使用正斜杠 \"/\" 或双反斜杠 \"\\\\\"</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string image_path </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">D:/path/to/your/image.jpg</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 2. 读取图像到 cv::Mat 对象</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // cv::imread(路径, 读取模式);</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat image </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image_path</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">IMREAD_COLOR</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 3. 检查图像是否成功加载</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">image</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cerr </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Could not open or find the image at: </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> image_path </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 4. 显示图像</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // cv::imshow(\"窗口标题\", 图像矩阵);</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Image Display</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> image</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 5. 等待按键</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // cv::waitKey(0);</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 等待无限久，直到有按键操作</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">3000</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 等待3000毫秒（3秒）后自动关闭窗口</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h3 id=\"cvimread-函数\"><a class=\"anchor\" href=\"#cvimread-函数\">#</a> <code>cv::imread()</code> 函数</h3>\n<p>用于从指定文件加载图像。</p>\n<ul>\n<li><strong>原型</strong>: <code>cv::Mat cv::imread(const std::string&amp; filename, int flags = IMREAD_COLOR)</code></li>\n<li><strong>参数</strong>:\n<ul>\n<li><code>filename</code>: 图像文件的完整路径。</li>\n<li><code>flags</code>: 读取模式，用于指定加载图像的颜色类型。</li>\n</ul>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>读取模式 (<code>flags</code>)</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>cv::IMREAD_COLOR</code></td>\n<td>加载彩色图像（BGR顺序），忽略Alpha通道。这是默认值。</td>\n</tr>\n<tr>\n<td><code>cv::IMREAD_GRAYSCALE</code></td>\n<td>以灰度模式加载图像。</td>\n</tr>\n<tr>\n<td><code>cv::IMREAD_UNCHANGED</code></td>\n<td>按原样加载图像，包括Alpha通道（如果存在）。</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"二-写入与保存图片\"><a class=\"anchor\" href=\"#二-写入与保存图片\">#</a> 二、写入与保存图片</h2>\n<p>使用 <code>cv::imwrite()</code> 函数可以将 <code>cv::Mat</code> 对象中的图像数据保存为文件。该函数可以根据文件扩展名（如 <code>.jpg</code>, <code>.png</code>）自动选择编码器。</p>\n<h3 id=\"1-常规保存\"><a class=\"anchor\" href=\"#1-常规保存\">#</a> 1. 常规保存</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">iostream</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string image_path </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">D:/path/to/your/image.png</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string output_path </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">D:/path/to/output_image.jpg</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat image </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image_path</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">IMREAD_COLOR</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">image</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cerr </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Could not read the image.</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // cv::imwrite(输出路径, 图像矩阵);</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    bool</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> isSuccess </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imwrite</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">output_path</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> image</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">isSuccess</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Image saved successfully to </span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> output_path </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cerr </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Failed to save the image.</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h3 id=\"2-保存时设置特定参数\"><a class=\"anchor\" href=\"#2-保存时设置特定参数\">#</a> 2. 保存时设置特定参数</h3>\n<p><code>cv::imwrite()</code> 的第三个参数 <code>params</code> 允许为特定图像格式设置保存选项，例如JPEG的质量或PNG的压缩级别。该参数是一个 <code>std::vector&lt;int&gt;</code> 类型的容器，其中参数成对出现：<code>&#123;参数标识符, 参数值&#125;</code>。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">iostream</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">vector</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // ... (加载图像代码同上) ...</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat image </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">D:/path/to/your/image.png</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">image</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string output_path_png </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">D:/path/to/output_compressed.png</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 设置PNG压缩级别为9（0-9，9为最高压缩）</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> png_params</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    png_params</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">push_back</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">IMWRITE_PNG_COMPRESSION</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    png_params</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">push_back</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">9</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 或者直接初始化</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // std::vector&#x3C;int> png_params = &#123;cv::IMWRITE_PNG_COMPRESSION, 9&#125;;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    bool</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> isSuccess </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imwrite</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">output_path_png</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> image</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> png_params</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">isSuccess</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cout </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">PNG with high compression saved successfully.</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cerr </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Failed to save the compressed PNG.</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h3 id=\"imwriteflags-常用参数\"><a class=\"anchor\" href=\"#imwriteflags-常用参数\">#</a> <code>ImwriteFlags</code> 常用参数</h3>\n<table>\n<thead>\n<tr>\n<th>参数标识符</th>\n<th>格式</th>\n<th>值范围</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>IMWRITE_JPEG_QUALITY</code></td>\n<td>JPEG</td>\n<td>0 - 100</td>\n<td>设置JPEG质量，值越高图像质量越好，文件越大。默认值为95。</td>\n</tr>\n<tr>\n<td><code>IMWRITE_PNG_COMPRESSION</code></td>\n<td>PNG</td>\n<td>0 - 9</td>\n<td>设置PNG压缩级别，值越高文件越小，但压缩时间越长。默认值为1（最快速度）。</td>\n</tr>\n<tr>\n<td><code>IMWRITE_PNG_STRATEGY</code></td>\n<td>PNG</td>\n<td>枚举值</td>\n<td>设置PNG压缩策略，如<code>IMWRITE_PNG_STRATEGY_RLE</code>。</td>\n</tr>\n<tr>\n<td><code>IMWRITE_WEBP_QUALITY</code></td>\n<td>WebP</td>\n<td>1 - 100</td>\n<td>设置WebP质量，100为无损。默认值为101（无损）。</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"三-创建与管理窗口\"><a class=\"anchor\" href=\"#三-创建与管理窗口\">#</a> 三、创建与管理窗口</h2>\n<p>OpenCV允许自动或手动创建窗口来显示图像。</p>\n<h3 id=\"1-自动创建窗口\"><a class=\"anchor\" href=\"#1-自动创建窗口\">#</a> 1. 自动创建窗口</h3>\n<p>调用 <code>cv::imshow()</code> 时，如果指定名称的窗口不存在，它会自动创建一个。这种窗口的大小会根据显示的图像自动调整，用户无法手动拖拽改变。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Auto Window</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> image</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 如果名为 \"Auto Window\" 的窗口不存在，则自动创建</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h3 id=\"2-手动创建窗口\"><a class=\"anchor\" href=\"#2-手动创建窗口\">#</a> 2. 手动创建窗口</h3>\n<p>使用 <code>cv::namedWindow()</code> 可以预先创建一个窗口，并指定其属性（如是否可调整大小）。之后 <code>cv::imshow()</code> 使用相同的窗口名称时，会将图像显示在该已创建的窗口中。</p>\n<ul>\n<li><strong><code>cv::namedWindow()</code></strong>: 创建一个窗口。</li>\n<li><strong><code>cv::resizeWindow()</code></strong>: 调整窗口大小。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 1. 手动创建一个可调整大小的窗口</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">namedWindow</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Manual Window</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">WINDOW_NORMAL</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 2. 在该窗口中显示图像</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Manual Window</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> image</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 3. 调整窗口大小</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">resizeWindow</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Manual Window</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 800</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 600</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 或者使用 cv::Size 对象</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// cv::Size new_size(800, 600);</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// cv::resizeWindow(\"Manual Window\", new_size);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h3 id=\"windowflags-窗口属性标志\"><a class=\"anchor\" href=\"#windowflags-窗口属性标志\">#</a> <code>WindowFlags</code> 窗口属性标志</h3>\n<table>\n<thead>\n<tr>\n<th>标志 (<code>flags</code>)</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>WINDOW_NORMAL</code></td>\n<td>用户可以手动拖拽调整窗口大小。</td>\n</tr>\n<tr>\n<td><code>WINDOW_AUTOSIZE</code></td>\n<td>窗口大小根据图像自动调整，用户无法更改。这是默认值。</td>\n</tr>\n<tr>\n<td><code>WINDOW_FULLSCREEN</code></td>\n<td>以全屏模式显示窗口。</td>\n</tr>\n<tr>\n<td><code>WINDOW_KEEPRATIO</code></td>\n<td>调整窗口大小时，图像保持原始宽高比。</td>\n</tr>\n<tr>\n<td><code>WINDOW_FREERATIO</code></td>\n<td>调整窗口大小时，图像填充整个窗口，不保持宽高比。</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"四-在一个窗口中显示多张图片\"><a class=\"anchor\" href=\"#四-在一个窗口中显示多张图片\">#</a> 四、在一个窗口中显示多张图片</h2>\n<p>要在一个窗口中以网格形式显示多张图片，并且保持每张图片的原始宽高比，核心思路是：</p>\n<ol>\n<li>创建一个足够大的空白画布（<code>cv::Mat</code>）。</li>\n<li>计算网格的行数和列数。</li>\n<li>遍历每张待显示的图片。</li>\n<li>对于每张图片，计算一个缩放比例，使其能完整地放入网格单元格内。</li>\n<li>将图片按此比例缩放。</li>\n<li>计算缩放后图片在单元格内居中的位置。</li>\n<li>将缩放后的图片复制到画布的正确位置上。</li>\n</ol>\n<h3 id=\"逻辑流程图\"><a class=\"anchor\" href=\"#逻辑流程图\">#</a> 逻辑流程图</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-mermaid\"><span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">graph TD</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    subgraph \"处理单张图片\"</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        A</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">获取图片原始尺寸 W_orig, H_orig</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> B</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">获取网格单元尺寸 W_cell, H_cell</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        B --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> C</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">计算缩放比 W_cell/W_orig, H_cell/H_orig</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        C --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> D</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">计算缩放后尺寸 W_new, H_new</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        D --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> E</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">缩放图片</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        E --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> F</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">计算在单元格内的居中偏移量 offsetX, offsetY</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        F --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> G</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">计算图片在画布上的最终ROI</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        G --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> H</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">将缩放后的图片复制到最终ROI</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    end</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    Start</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">开始</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> A;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    H --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> Loop</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">是否还有图片?</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    Loop -- 是 --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> A;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    Loop -- 否 --</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> End</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">显示最终画布</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">]</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">;</span></span></code></pre>\n<h3 id=\"示例代码\"><a class=\"anchor\" href=\"#示例代码\">#</a> 示例代码</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">iostream</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">vector</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">cmath</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">algorithm</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">/**</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> * </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">@brief</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> 在一个网格中显示多张图片，并保持每张图片的原始宽高比。</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> * </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">@param</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> images</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> 待显示的cv::Mat图片向量。</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> * </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">@param</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> windowName</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> 显示窗口的标题。</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> * </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">@param</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> cell_size</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> 网格中每个单元格的尺寸。</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> */</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">void</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> showImagesInGrid</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">vector</span><span style=\"color:#999999;--shiki-dark:#666666\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Mat</span><span style=\"color:#999999;--shiki-dark:#666666\">></span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> images</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">                      const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">string</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> windowName</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Image Grid</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">                      const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Size</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> cell_size</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Size</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">400</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 300</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">images</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> return</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 计算网格布局</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> imageCount </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> images</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">size</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cols </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> static_cast</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">ceil</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">sqrt</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">imageCount</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> rows </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> static_cast</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">ceil</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">static_cast</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">double</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">imageCount</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cols</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 创建大画布</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat </span><span style=\"color:#59873A;--shiki-dark:#80A665\">canvas</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">rows </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> cell_size</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">height</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cols </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> cell_size</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">width</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> CV_8UC3</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">20</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 20</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 20</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    for</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> i </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> i </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> imageCount</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> ++</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">i</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">        const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> originalImage </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> images</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">[</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">i</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">]</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">originalImage</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> continue</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 1. 计算保持宽高比的缩放比例</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">        double</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> scale </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">min</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">            static_cast</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">double</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cell_size</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">width</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> originalImage</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cols</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">            static_cast</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">double</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cell_size</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">height</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> originalImage</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">rows</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 2. 缩放图片</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Size </span><span style=\"color:#59873A;--shiki-dark:#80A665\">newSize</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">static_cast</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">originalImage</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cols</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> scale</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> static_cast</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">originalImage</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">rows</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> scale</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat resizedImage</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">resize</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">originalImage</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> resizedImage</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> newSize</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">INTER_AREA</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 3. 计算图片在画布上的目标位置 (ROI)</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">        int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cell_col </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> i </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">%</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cols</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">        int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cell_row </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> i </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">/</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cols</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">        int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cell_X </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cell_col </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> cell_size</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">width</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">        int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cell_Y </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cell_row </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> cell_size</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">height</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">        int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> offsetX </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cell_size</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">width</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> newSize</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">width</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">        int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> offsetY </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cell_size</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">height</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> newSize</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">height</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Rect </span><span style=\"color:#59873A;--shiki-dark:#80A665\">targetRoi</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cell_X </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> offsetX</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cell_Y </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">+</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> offsetY</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> newSize</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">width</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> newSize</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">height</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 4. 将缩放后的图片复制到画布</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        resizedImage</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">copyTo</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">canvas</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">targetRoi</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windowName</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> canvas</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 假设已加载多张图片到 std::vector&#x3C;cv::Mat> srcImages;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\">std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> imagePaths </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">        \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">D:/path/to/image1.jpg</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">        \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">D:/path/to/image2.png</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">        \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">D:/path/to/image3.jpg</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">        \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">D:/path/to/image4.png</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> srcImages</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    for</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> auto&#x26;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> path </span><span style=\"color:#999999;--shiki-dark:#666666\">:</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> imagePaths</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat img </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">path</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">!</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">img</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">            srcImages</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">push_back</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">img</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImages</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cerr </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Error: No images were loaded.</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    showImagesInGrid</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImages</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n",
            "tags": [
                "OpenCV"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/OpenCV/opencv%E5%9B%BE%E5%BD%A2%E6%96%87%E5%AD%97%E7%BB%98%E5%88%B6/",
            "url": "https://haoruanwn.github.io/2025/07/28/OpenCV/opencv%E5%9B%BE%E5%BD%A2%E6%96%87%E5%AD%97%E7%BB%98%E5%88%B6/",
            "title": "opencv图形文字绘制",
            "date_published": "2025-07-28T13:38:38.000Z",
            "content_html": "<h2 id=\"一-绘制矩形\"><a class=\"anchor\" href=\"#一-绘制矩形\">#</a> 一、绘制矩形</h2>\n<p>使用 <code>cv::rectangle</code> 函数在图像上绘制矩形。该函数有两种常见的重载形式：一种使用 <code>cv::Rect</code> 对象，另一种使用两个 <code>cv::Point</code> 对象（左上角和右下角顶点）。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">参数</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><code>img</code></td>\n<td style=\"text-align:left\">目标图像。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>rec</code></td>\n<td style=\"text-align:left\"><code>cv::Rect</code> 类型的矩形区域。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>pt1</code></td>\n<td style=\"text-align:left\">矩形的左上角顶点。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>pt2</code></td>\n<td style=\"text-align:left\">矩形的右下角顶点。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>color</code></td>\n<td style=\"text-align:left\">矩形边框的颜色，使用 <code>cv::Scalar</code> 表示。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>thickness</code></td>\n<td style=\"text-align:left\">边框线的粗细。如果为负值（如-1），则表示填充整个矩形。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>lineType</code></td>\n<td style=\"text-align:left\">线的类型，默认为 <code>cv::LINE_8</code>。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>shift</code></td>\n<td style=\"text-align:left\">坐标点的小数位数。</td>\n</tr>\n</tbody>\n</table>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string image_path </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">path/to/your/image.jpg</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string windows_name </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Drawing Shapes</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat srcImg </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        printf</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">could not load image...</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 1. 使用 cv::Rect 定义矩形</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Rect </span><span style=\"color:#59873A;--shiki-dark:#80A665\">rec</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">10</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 30</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 600</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 200</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 2. 绘制空心矩形，线条粗细为 5</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rectangle</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> rec</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 5</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 3. 绘制实心矩形 (thickness = -1)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // cv::rectangle(srcImg, rec, cv::Scalar(255, 0, 0), -1);</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 4. 使用两个 cv::Point 定义矩形并绘制</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">rectangle</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">10</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 30</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">610</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 230</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> srcImg</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<hr />\n<h2 id=\"二-绘制圆形\"><a class=\"anchor\" href=\"#二-绘制圆形\">#</a> 二、绘制圆形</h2>\n<p>使用 <code>cv::circle</code> 函数在图像上绘制圆形。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">参数</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><code>img</code></td>\n<td style=\"text-align:left\">目标图像。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>center</code></td>\n<td style=\"text-align:left\">圆心的坐标 <code>cv::Point</code>。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>radius</code></td>\n<td style=\"text-align:left\">圆的半径（以像素为单位）。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>color</code></td>\n<td style=\"text-align:left\">圆边框的颜色，使用 <code>cv::Scalar</code> 表示。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>thickness</code></td>\n<td style=\"text-align:left\">边框线的粗细。如果为负值（如-1），则表示填充整个圆形。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>lineType</code></td>\n<td style=\"text-align:left\">线的类型，默认为 <code>cv::LINE_8</code>。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>shift</code></td>\n<td style=\"text-align:left\">坐标点的小数位数。</td>\n</tr>\n</tbody>\n</table>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string image_path </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">path/to/your/image.jpg</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string windows_name </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Drawing Shapes</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat srcImg </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        printf</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">could not load image...</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 在图像上绘制一个半径为100，线条粗细为2的绿色圆形</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">circle</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">300</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 300</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> srcImg</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<hr />\n<h2 id=\"三-绘制椭圆形\"><a class=\"anchor\" href=\"#三-绘制椭圆形\">#</a> 三、绘制椭圆形</h2>\n<p>使用 <code>cv::ellipse</code> 函数在图像上绘制椭圆或椭圆弧。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">参数</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><code>img</code></td>\n<td style=\"text-align:left\">目标图像。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>center</code></td>\n<td style=\"text-align:left\">椭圆中心的坐标 <code>cv::Point</code>。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>axes</code></td>\n<td style=\"text-align:left\">椭圆长轴和短轴的一半长度，用 <code>cv::Size</code> 表示。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>angle</code></td>\n<td style=\"text-align:left\">椭圆的旋转角度（顺时针方向）。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>startAngle</code></td>\n<td style=\"text-align:left\">椭圆弧的起始角度。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>endAngle</code></td>\n<td style=\"text-align:left\">椭圆弧的结束角度。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>color</code></td>\n<td style=\"text-align:left\">椭圆的颜色，使用 <code>cv::Scalar</code> 表示。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>thickness</code></td>\n<td style=\"text-align:left\">边框线的粗细。如果为负值（如-1），则表示填充整个椭圆。</td>\n</tr>\n</tbody>\n</table>\n<p><strong>注意</strong>:</p>\n<ul>\n<li>通过设置不同的 <code>startAngle</code> 和 <code>endAngle</code> 可以绘制椭圆弧。</li>\n<li>将长轴和短轴设置为相等的值，即可绘制出一个（可能旋转了的）圆形或圆弧。</li>\n</ul>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string image_path </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">path/to/your/image.jpg</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string windows_name </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Drawing Shapes</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat srcImg </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        printf</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">could not load image...</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 绘制一个完整的绿色椭圆</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">ellipse</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cols</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">rows</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 中心点</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Size</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">200</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  // 长轴和短轴长度的一半</span></span>\n<span class=\"line\"><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">                0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">                  // 旋转角度</span></span>\n<span class=\"line\"><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">                0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">                  // 起始角度</span></span>\n<span class=\"line\"><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">                360</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">                // 结束角度</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 颜色</span></span>\n<span class=\"line\"><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">                2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">                 // 粗细</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 绘制一个红色椭圆弧</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">ellipse</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cols</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">rows</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Size</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">200</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">                30</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">                 // 旋转30度</span></span>\n<span class=\"line\"><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">                0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">                180</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">                // 绘制上半部分的弧线</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">                cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">                2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">namedWindow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">WINDOW_NORMAL</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> srcImg</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">resizeWindow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 800</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 480</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<hr />\n<h2 id=\"四-绘制线段与多边形\"><a class=\"anchor\" href=\"#四-绘制线段与多边形\">#</a> 四、绘制线段与多边形</h2>\n<h3 id=\"1-绘制线段\"><a class=\"anchor\" href=\"#1-绘制线段\">#</a> 1. 绘制线段</h3>\n<p>使用 <code>cv::line</code> 函数绘制一条直线段。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">参数</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><code>img</code></td>\n<td style=\"text-align:left\">目标图像。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>pt1</code></td>\n<td style=\"text-align:left\">线段的起点 <code>cv::Point</code>。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>pt2</code></td>\n<td style=\"text-align:left\">线段的终点 <code>cv::Point</code>。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>color</code></td>\n<td style=\"text-align:left\">线的颜色，使用 <code>cv::Scalar</code> 表示。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>thickness</code></td>\n<td style=\"text-align:left\">线的粗细。</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-绘制多边形\"><a class=\"anchor\" href=\"#2-绘制多边形\">#</a> 2. 绘制多边形</h3>\n<ul>\n<li><strong><code>cv::polylines</code></strong>: 绘制多边形的轮廓。</li>\n<li><strong><code>cv::fillPoly</code></strong>: 绘制并填充一个或多个多边形。</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">函数</th>\n<th style=\"text-align:left\">参数</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><code>cv::polylines</code></td>\n<td style=\"text-align:left\"><code>img</code></td>\n<td style=\"text-align:left\">目标图像。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"><code>pts</code></td>\n<td style=\"text-align:left\"><code>cv::Point</code> 类型的数组或向量的数组。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"><code>isClosed</code></td>\n<td style=\"text-align:left\">布尔值，指示是否闭合多边形。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"><code>color</code></td>\n<td style=\"text-align:left\">颜色。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"><code>thickness</code></td>\n<td style=\"text-align:left\">线宽。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>cv::fillPoly</code></td>\n<td style=\"text-align:left\"><code>img</code></td>\n<td style=\"text-align:left\">目标图像。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"><code>pts</code></td>\n<td style=\"text-align:left\"><code>cv::Point</code> 类型的数组或向量的数组。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\"><code>color</code></td>\n<td style=\"text-align:left\">颜色。</td>\n</tr>\n</tbody>\n</table>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">vector</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string image_path </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">path/to/your/image.jpg</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string windows_name </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Drawing Shapes</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat srcImg </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        printf</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">could not load image...</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 1. 绘制线段 (主对角线)</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">line</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cols</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">rows</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 2. 准备多边形的顶点</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Point</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> polygon_points </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">100</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">250</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 150</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">300</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 300</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">150</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 250</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 3. 绘制多边形轮廓 (不填充)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // cv::polylines(srcImg, polygon_points, true, cv::Scalar(0, 255, 255), 3);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 4. 绘制填充多边形</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">fillPoly</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> polygon_points</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">namedWindow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">WINDOW_NORMAL</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> srcImg</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">resizeWindow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 800</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 480</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h2 id=\"五-绘制文字\"><a class=\"anchor\" href=\"#五-绘制文字\">#</a> 五、绘制文字</h2>\n<p>在OpenCV中，使用 <code>cv::putText</code> 函数可以在图像上绘制文字。要精确控制文字的位置（例如居中），则需要借助 <code>cv::getTextSize</code> 来预先获取文本的尺寸。</p>\n<hr />\n<p><strong><code>cv::putText</code> 函数</strong></p>\n<p>该函数用于在图像的指定位置绘制文本字符串。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">参数</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><code>img</code></td>\n<td style=\"text-align:left\">目标图像。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>text</code></td>\n<td style=\"text-align:left\">要绘制的文本内容，为 <code>std::string</code> 类型。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>org</code></td>\n<td style=\"text-align:left\">文本框的左下角坐标，为 <code>cv::Point</code> 类型。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>fontFace</code></td>\n<td style=\"text-align:left\">字体类型，如 <code>cv::FONT_HERSHEY_SIMPLEX</code>。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>fontScale</code></td>\n<td style=\"text-align:left\">字体大小的缩放比例。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>color</code></td>\n<td style=\"text-align:left\">文本颜色，使用 <code>cv::Scalar</code> 表示。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>thickness</code></td>\n<td style=\"text-align:left\">构成文本的线条粗细。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>lineType</code></td>\n<td style=\"text-align:left\">线条类型，默认为 <code>cv::LINE_8</code>。</td>\n</tr>\n</tbody>\n</table>\n<p><strong>基本用法:</strong></p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 在图像大致中心的位置绘制黑色文字 \"Mahiro\"</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">putText</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Mahiro</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">150</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 250</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">FONT_HERSHEY_SIMPLEX</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">            cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<blockquote>\n<p><strong>注意</strong>：<code>org</code> 参数指定的是文本基线的左端点，而不是文本框的中心点或左上角。</p>\n</blockquote>\n<hr />\n<p><strong>将文字居中绘制</strong></p>\n<p>为了将文字的<strong>中心</strong>放置在图像的特定坐标 <code>(cx, cy)</code> 上，需要以下步骤：</p>\n<ol>\n<li>使用 <code>cv::getTextSize</code> 函数获取文本在特定字体、大小和粗细下的像素宽度和高度。</li>\n<li>根据获取到的尺寸计算出文本框的中心点。</li>\n<li>通过 <code>(cx, cy)</code> 和文本尺寸，反向计算出 <code>cv::putText</code> 所需的左下角坐标 <code>(x, y)</code>。\n<ul>\n<li><code>x = cx - (文本宽度 / 2)</code></li>\n<li><code>y = cy + (文本高度 / 2)</code></li>\n</ul>\n</li>\n</ol>\n<p><strong><code>cv::getTextSize</code> 函数</strong></p>\n<p>该函数计算并返回刚好能包裹指定文本的矩形框的大小。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">参数</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><code>text</code></td>\n<td style=\"text-align:left\">要测量的文本字符串。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>fontFace</code></td>\n<td style=\"text-align:left\">字体类型，必须与 <code>cv::putText</code> 中使用的一致。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>fontScale</code></td>\n<td style=\"text-align:left\">字体大小，必须与 <code>cv::putText</code> 中使用的一致。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>thickness</code></td>\n<td style=\"text-align:left\">线条粗细，必须与 <code>cv::putText</code> 中使用的一致。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>baseline</code></td>\n<td style=\"text-align:left\">一个整型指针，函数会通过它返回基线相对于文本框底部的y坐标。</td>\n</tr>\n</tbody>\n</table>\n<p><strong>完整示例代码</strong></p>\n<p>下面的代码创建一个类，实现计算并在图像中心绘制文本。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">string</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// --- TextDrawer 类 ---</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">class</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> TextDrawer</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">public</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 构造函数，用于设置默认文本样式</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    TextDrawer</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> fontFace</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">FONT_HERSHEY_SIMPLEX</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> double</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> fontScale</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1.0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">               const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Scalar</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> color</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> 255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> 255</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> thickness </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        :</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> m_fontFace</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">fontFace</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> m_fontScale</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">fontScale</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> m_color</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">color</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> m_thickness</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">thickness</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 核心方法：在指定中心点绘制居中文字</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    void</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> drawCentered</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Mat</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> img</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">string</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> text</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Point</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> centerPoint</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> const</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">        int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> baseline </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Size textSize </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">getTextSize</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">text</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_fontFace</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_fontScale</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_thickness</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">baseline</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Point </span><span style=\"color:#59873A;--shiki-dark:#80A665\">textOrigin</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">centerPoint</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">x</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> textSize</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">width</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">                             centerPoint</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">y</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> +</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> textSize</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">height</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        </span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">putText</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">img</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> text</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> textOrigin</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_fontFace</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_fontScale</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_color</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_thickness</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 也可提供一个绘制非居中文字的方法</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    void</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> draw</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Mat</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> img</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">string</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> text</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Point</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> origin</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> const</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">putText</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">img</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> text</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> origin</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_fontFace</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_fontScale</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_color</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_thickness</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 可以提供修改样式的接口</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    void</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> setStyle</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">double</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> newScale</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Scalar</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> newColor</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        m_fontScale </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> newScale</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        m_color </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> newColor</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">private</span><span style=\"color:#999999;--shiki-dark:#666666\">:</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 成员变量，保存文本样式</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_fontFace</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    double</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_fontScale</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Scalar m_color</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    int</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> m_thickness</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // ... 加载图像同上 ...</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string image_path </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">your_image.jpg</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string windows_name </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Class-based Text Drawing</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat srcImg </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        srcImg </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Mat</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">zeros</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">600</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 1000</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> CV_8UC3</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">        srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">setTo</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">20</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 20</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 20</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // --- 使用 TextDrawer ---</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 1. 创建一个用于绘制大标题的 \"Drawer\"</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    TextDrawer </span><span style=\"color:#59873A;--shiki-dark:#80A665\">titleDrawer</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">FONT_HERSHEY_SIMPLEX</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 4.5</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 3</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 2. 创建一个用于绘制副标题的 \"Drawer\"</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    TextDrawer </span><span style=\"color:#59873A;--shiki-dark:#80A665\">subtitleDrawer</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">FONT_HERSHEY_DUPLEX</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2.0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">100</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 100</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 3. 使用它们进行绘制</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Point </span><span style=\"color:#59873A;--shiki-dark:#80A665\">imageCenter</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cols</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">rows</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    titleDrawer</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">drawCentered</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Mahiro</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> imageCenter</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    subtitleDrawer</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">drawCentered</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Class-based Style!</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">imageCenter</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">x</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> imageCenter</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">y</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> +</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 200</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // ... 显示图像 ...</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">namedWindow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">WINDOW_NORMAL</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> srcImg</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">resizeWindow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 800</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 480</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h2 id=\"六-应用示例提取多边形roi\"><a class=\"anchor\" href=\"#六-应用示例提取多边形roi\">#</a> 六、应用示例：提取多边形ROI</h2>\n<p>在图像处理中，ROI (Region of Interest) 是指图像中我们感兴趣的特定区域。一个常见的任务是根据一个不规则的多边形来定义和提取这个区域。其核心思想是利用掩码（Mask）来标定ROI，然后将掩码应用到原始图像上，从而分离出所需部分。</p>\n<hr />\n<h3 id=\"实现步骤\"><a class=\"anchor\" href=\"#实现步骤\">#</a> 实现步骤</h3>\n<ol>\n<li><strong>定义多边形顶点</strong>: 首先，使用一个点的向量 <code>std::vector&lt;cv::Point&gt;</code> 来定义构成ROI边界的多边形顶点坐标。</li>\n<li><strong>创建与绘制掩码 (Mask)</strong>:\n<ul>\n<li>创建一个与原图像尺寸相同、内容全黑的 <code>cv::Mat</code> 对象作为掩码。</li>\n<li>使用 <code>cv::fillPoly</code> 函数，在全黑的掩码上将上一步定义的多边形区域填充为白色（像素值为255）。这样，掩码上白色区域就精确地对应了我们感兴趣的多边形区域。</li>\n</ul>\n</li>\n<li><strong>应用掩码提取ROI</strong>:\n<ul>\n<li>调用 <code>cv::Mat::copyTo</code> 方法，并传入上一步生成的掩码。</li>\n<li>该方法会遍历掩码，仅将原图像中与掩码白色区域（非零像素）对应的像素复制到目标图像中。掩码黑色区域（零像素）对应的部分则不被复制。</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"代码示例\"><a class=\"anchor\" href=\"#代码示例\">#</a> 代码示例</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">vector</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string image_path </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">path/to/your/image.jpg</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string windows_name </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Polygon ROI</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat srcImg </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        printf</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">could not load image...</span><span style=\"color:#A65E2B;--shiki-dark:#C99076\">\\n</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 1. 定义多边形的顶点</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">vector</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Point</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> points </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cols</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cols</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">rows</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> /</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 2</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Point</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">rows</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 2. 创建一个全黑的掩码</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat mask </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Mat</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">zeros</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">size</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">type</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 3. 在掩码上将多边形区域填充为白色</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">fillPoly</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">mask</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> points</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">Scalar</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 4. 使用 copyTo 和掩码来提取ROI</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat dstImg</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#B07D48;--shiki-dark:#BD976A\">    srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">copyTo</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">dstImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> mask</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 该操作只复制掩码中像素值不为0的区域</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">namedWindow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">WINDOW_NORMAL</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> dstImg</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">resizeWindow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 800</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 480</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h3 id=\"实现效果\"><a class=\"anchor\" href=\"#实现效果\">#</a> 实现效果</h3>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/202506202320527.png\" alt=\"QQ20250620-231524\" /></p>\n<ul>\n<li>最终显示的目标图像 <code>dstImg</code> 将会是一张背景为黑色的图片。</li>\n<li>图像中只有被多边形框选的区域会显示原始图像的内容，其他部分（即多边形外部的区域）则为黑色，从而实现了对特定不规则区域的精确提取。</li>\n</ul>\n<h3 id=\"应用场景\"><a class=\"anchor\" href=\"#应用场景\">#</a> 应用场景</h3>\n<ul>\n<li><strong>车道线检测</strong>: 在自动驾驶中，可以提取出图像中的车道区域，以减少后续处理的计算量和干扰。</li>\n<li><strong>物体分割</strong>: 在目标识别任务中，可以用于分割出感兴趣的物体，以便进行后续的特征分析或识别。</li>\n</ul>\n",
            "tags": [
                "OpenCV"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/OpenCV/opencv%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E6%A8%A1%E5%9D%97/",
            "url": "https://haoruanwn.github.io/2025/07/28/OpenCV/opencv%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86%E6%A8%A1%E5%9D%97/",
            "title": "opencv图像处理模块",
            "date_published": "2025-07-28T13:38:28.000Z",
            "content_html": "<h2 id=\"一-颜色空间变换\"><a class=\"anchor\" href=\"#一-颜色空间变换\">#</a> 一、颜色空间变换</h2>\n<p>在数字图像处理中，颜色空间（Color Space）是描述和表示颜色的数学模型。OpenCV默认使用的颜色空间是BGR（蓝-绿-红），但在特定任务中，转换到其他颜色空间会更加有效。</p>\n<h3 id=\"1-cvcvtcolor-函数\"><a class=\"anchor\" href=\"#1-cvcvtcolor-函数\">#</a> 1. <code>cv::cvtColor</code> 函数</h3>\n<p>OpenCV使用 <code>cv::cvtColor</code> 函数来进行颜色空间变换。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 原型</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">void</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cvtColor</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">InputArray</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> src</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">     // 输入图像</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">OutputArray</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> dst</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 输出图像</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    int</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> code</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">               // 颜色空间转换代码</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    int</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> dstCn</span><span style=\"color:#999999;--shiki-dark:#666666\"> =</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">           // 目标图像的通道数，0表示根据输入和代码自动确定</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h3 id=\"2-常用颜色空间及其转换\"><a class=\"anchor\" href=\"#2-常用颜色空间及其转换\">#</a> 2. 常用颜色空间及其转换</h3>\n<p>不同的颜色空间有不同的应用场景。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">颜色空间</th>\n<th style=\"text-align:left\">转换代码</th>\n<th style=\"text-align:left\">描述与用途</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>Grayscale</strong> (灰度)</td>\n<td style=\"text-align:left\"><code>cv::COLOR_BGR2GRAY</code></td>\n<td style=\"text-align:left\">将彩色图像转换为单通道的灰度图像，只包含亮度信息。常用于简化图像，减少计算量，是许多算法（如边缘检测）的预处理步骤。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>HSV</strong> (色相, 饱和度, 明度)</td>\n<td style=\"text-align:left\"><code>cv::COLOR_BGR2HSV</code></td>\n<td style=\"text-align:left\">一种更符合人类视觉感知的颜色模型。在HSV空间中，颜色（Hue）信息与光照强度（Value）分离，非常适合用于基于颜色的对象分割和跟踪。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>YUV</strong></td>\n<td style=\"text-align:left\"><code>cv::COLOR_BGR2YUV</code></td>\n<td style=\"text-align:left\">将亮度（Y）与色度（U, V）分量分离。广泛应用于视频编码和传输，因为它允许在不显著影响视觉质量的情况下降低色度信息的分辨率。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>Lab</strong></td>\n<td style=\"text-align:left\"><code>cv::COLOR_BGR2Lab</code></td>\n<td style=\"text-align:left\">一种感知上均匀的颜色空间，即在空间中两个颜色之间的欧氏距离能更好地对应人眼感知的颜色差异。常用于颜色测量和比较。</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"3-示例颜色分割\"><a class=\"anchor\" href=\"#3-示例颜色分割\">#</a> 3. 示例：颜色分割</h3>\n<p>利用HSV颜色空间可以方便地筛选出特定颜色的区域。<code>cv::inRange</code> 函数可以检查图像中的像素值是否在指定的上下限范围内，并生成一个二值掩码（mask）。</p>\n<ul>\n<li><strong><code>cv::inRange(src, lowerb, upperb, dst)</code></strong>:\n<ul>\n<li><code>src</code>: 输入的HSV图像。</li>\n<li><code>lowerb</code>: 颜色的下限值（如<code>cv::Scalar(h_min, s_min, v_min)</code>）。</li>\n<li><code>upperb</code>: 颜色的上限值（如<code>cv::Scalar(h_max, s_max, v_max)</code>）。</li>\n<li><code>dst</code>: 输出的单通道二值掩码。在范围内的像素点设置为255（白色），否则设置为0（黑色）。</li>\n</ul>\n</li>\n</ul>\n<p>下面的代码演示了将BGR图像转换为灰度图和HSV图，并使用<code>cv::inRange</code>在HSV空间中提取红色部分。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">iostream</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 假设 image_path 已定义</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// const std::string image_path = \"your_image.jpg\";</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 读取原始BGR图像</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat srcImage </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">srcImage</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cerr </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Could not open or find the image</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 1. 转换为灰度图</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat grayImage</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cvtColor</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImage</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> grayImage</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">COLOR_BGR2GRAY</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 2. 转换为HSV图</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat hsvImage</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cvtColor</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImage</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> hsvImage</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">COLOR_BGR2HSV</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 3. 在HSV空间中提取红色区域</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 定义红色的HSV范围，注意OpenCV中H范围为[0, 180]</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Scalar </span><span style=\"color:#59873A;--shiki-dark:#80A665\">red_low</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">156</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 43</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 46</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">   // H(色相), S(饱和度), V(明度) 下限</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Scalar </span><span style=\"color:#59873A;--shiki-dark:#80A665\">red_up</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">180</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">  // H, S, V 上限</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat red_mask</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 用于存放红色区域的掩码</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // inRange函数会遍历hsvImage中的每个像素，</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 如果像素值在red_low和red_up之间，则在red_mask对应位置设为255，否则设为0</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">inRange</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">hsvImage</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> red_low</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> red_up</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> red_mask</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 显示结果</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Original BGR</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> srcImage</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Grayscale</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> grayImage</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">HSV</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> hsvImage</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Red Part Mask</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> red_mask</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h4 id=\"实现效果\"><a class=\"anchor\" href=\"#实现效果\">#</a> 实现效果</h4>\n<p>下图展示了原始图像、灰度图、HSV图以及提取出的红色区域掩码。</p>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/202506192322418.png\" alt=\"QQ20250619-232100\" /></p>\n<h2 id=\"二-scalar像素值容器\"><a class=\"anchor\" href=\"#二-scalar像素值容器\">#</a> 二、Scalar：像素值容器</h2>\n<p><code>cv::Scalar</code> 是一个可以存储1到4个数值的模板类，常用于表示和传递像素值。它本质上是一个包含四个元素的vector，可以灵活地表示单通道（灰度）、三通道（BGR）或四通道（BGRA）的像素。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">通道数</th>\n<th style=\"text-align:left\">用途</th>\n<th style=\"text-align:left\">初始化示例</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>1</strong></td>\n<td style=\"text-align:left\">灰度图像</td>\n<td style=\"text-align:left\"><code>cv::Scalar(128)</code></td>\n<td style=\"text-align:left\">第一个通道设为128，其余通道默认为0。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>3</strong></td>\n<td style=\"text-align:left\">BGR彩色图像</td>\n<td style=\"text-align:left\"><code>cv::Scalar(0, 255, 255)</code></td>\n<td style=\"text-align:left\">按B, G, R顺序分别赋值。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>4</strong></td>\n<td style=\"text-align:left\">BGRA带透明度图像</td>\n<td style=\"text-align:left\"><code>cv::Scalar(0, 255, 255, 255)</code></td>\n<td style=\"text-align:left\">按B, G, R, Alpha顺序分别赋值。</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"在cvmat构造函数中的应用\"><a class=\"anchor\" href=\"#在cvmat构造函数中的应用\">#</a> 在<code>cv::Mat</code>构造函数中的应用</h3>\n<p>在使用<code>cv::Mat</code>的构造函数创建图像时，<code>cv::Scalar</code>可以用来初始化图像的所有像素。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">Mat</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> mat</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\">rows</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> cols</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> type</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2E8F82;--shiki-dark:#5DA994\"> scalar</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h4 id=\"type参数详解\"><a class=\"anchor\" href=\"#type参数详解\">#</a> <code>type</code>参数详解</h4>\n<p><code>type</code>参数定义了矩阵中每个元素的数据类型和通道数，其格式为 <code>CV_&lt;bit_depth&gt;&lt;S/U/F&gt;C&lt;channels&gt;</code>。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">组成部分</th>\n<th style=\"text-align:left\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>bit_depth</strong></td>\n<td style=\"text-align:left\">每个通道的位数，如 <code>8</code>, <code>16</code>, <code>32</code>, <code>64</code>。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>S/U/F</strong></td>\n<td style=\"text-align:left\">数据类型：<code>S</code> (signed-有符号整型), <code>U</code> (unsigned-无符号整型), <code>F</code> (float-浮点型)。</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>C&lt;channels&gt;</strong></td>\n<td style=\"text-align:left\">通道数，如 <code>C1</code>, <code>C2</code>, <code>C3</code>, <code>C4</code>。</td>\n</tr>\n</tbody>\n</table>\n<p><strong>示例解析:</strong></p>\n<ul>\n<li><code>CV_8UC1</code>: 8位无符号单通道图像。像素值范围为 [0, 255]。</li>\n<li><code>CV_32FC3</code>: 32位浮点型三通道图像。像素值范围通常为 [0.0, 1.0]。</li>\n</ul>\n<p><strong>注意</strong>: 当进行频繁的图像处理（如滤波、几何变换）时，使用 <code>CV_8U</code> 可能会因其有限的精度（0-255的整数）导致累积误差和图像失真。在这种情况下，推荐使用 <code>CV_32F</code> 或 <code>CV_64F</code> 等浮点数类型以保留更高的精度。</p>\n<h3 id=\"代码示例\"><a class=\"anchor\" href=\"#代码示例\">#</a> 代码示例</h3>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 示例1: 创建一个灰度图像</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // cv::Scalar(128) -> 单通道，第一个值有效，代表灰度值。0为黑，255为白。</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Scalar </span><span style=\"color:#59873A;--shiki-dark:#80A665\">scalar1</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">128</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat </span><span style=\"color:#59873A;--shiki-dark:#80A665\">mat1</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">120</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 240</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> CV_8UC1</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> scalar1</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Grayscale Image</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> mat1</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 示例2: 创建一个彩色图像</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // cv::Scalar(0, 255, 255) -> BGR三通道。B=0, G=255, R=255。</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 使用32F类型，imshow会自动将[0.0, 1.0]范围映射到[0, 255]进行显示。</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Scalar </span><span style=\"color:#59873A;--shiki-dark:#80A665\">scalar2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat </span><span style=\"color:#59873A;--shiki-dark:#80A665\">mat2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">120</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 240</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> CV_8UC3</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> scalar2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Color Image</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> mat2</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h2 id=\"三-给图片加边框\"><a class=\"anchor\" href=\"#三-给图片加边框\">#</a> 三、给图片加边框</h2>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat srcImg </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imread</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat dstImg</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 产生随机数的类</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">RNG </span><span style=\"color:#59873A;--shiki-dark:#80A665\">rng</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">time</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">NULL</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 使用当前时间作为种子</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 特殊类，cv::RNG,用于产生随机数</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    while</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">true</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Scalar </span><span style=\"color:#59873A;--shiki-dark:#80A665\">value</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">rng</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">uniform</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> rng</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">uniform</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> rng</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">uniform</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 黑色边界</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 参数：输入图像，输出图像，上下左右边距，边界类型，边界值</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">copyMakeBorder</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">srcImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> dstImg</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 50</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 50</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 50</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 50</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">BORDER_CONSTANT</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> value</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 常用的边界类型：</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">namedWindow</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">WINDOW_NORMAL</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">imshow</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> dstImg</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">resizeWindow</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 800</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 480</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">100</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> ==</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 27</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            break</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<p>示例：</p>\n<p><img loading=\"lazy\" src=\"https://markdownforyuanhao.oss-cn-hangzhou.aliyuncs.com/img1/202506242254834.png\" alt=\"QQ20250624-225005\" /></p>\n",
            "tags": [
                "OpenCV"
            ]
        },
        {
            "id": "https://haoruanwn.github.io/2025/07/28/OpenCV/opencv%E4%BA%8B%E4%BB%B6/",
            "url": "https://haoruanwn.github.io/2025/07/28/OpenCV/opencv%E4%BA%8B%E4%BB%B6/",
            "title": "opencv事件",
            "date_published": "2025-07-28T13:38:01.000Z",
            "content_html": "<h2 id=\"一-鼠标事件的响应\"><a class=\"anchor\" href=\"#一-鼠标事件的响应\">#</a> 一、鼠标事件的响应</h2>\n<p>当鼠标在窗口上进行操作（如点击、移动、滚轮滚动）时，会触发一个鼠标事件。OpenCV允许我们通过设置一个回调函数来响应这些事件。</p>\n<h3 id=\"1-常见鼠标事件\"><a class=\"anchor\" href=\"#1-常见鼠标事件\">#</a> 1. 常见鼠标事件</h3>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">事件常量 (event)</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_MOUSEMOVE</code></td>\n<td style=\"text-align:left\">鼠标移动</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_LBUTTONDOWN</code></td>\n<td style=\"text-align:left\">左键按下</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_RBUTTONDOWN</code></td>\n<td style=\"text-align:left\">右键按下</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_MBUTTONDOWN</code></td>\n<td style=\"text-align:left\">中键按下</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_LBUTTONUP</code></td>\n<td style=\"text-align:left\">左键松开</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_RBUTTONUP</code></td>\n<td style=\"text-align:left\">右键松开</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_MBUTTONUP</code></td>\n<td style=\"text-align:left\">中键松开</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_LBUTTONDBLCLK</code></td>\n<td style=\"text-align:left\">左键双击</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_RBUTTONDBLCLK</code></td>\n<td style=\"text-align:left\">右键双击</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_MBUTTONDBLCLK</code></td>\n<td style=\"text-align:left\">中键双击</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_MOUSEWHEEL</code></td>\n<td style=\"text-align:left\">滚轮向前滚动</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_MOUSEHWHEEL</code></td>\n<td style=\"text-align:left\">滚轮向后滚动</td>\n</tr>\n</tbody>\n</table>\n<p>这些事件通常与标志位（flags）结合使用，以判断组合键状态。</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">标志常量 (flags)</th>\n<th style=\"text-align:left\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_FLAG_LBUTTON</code></td>\n<td style=\"text-align:left\">左键被按下</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_FLAG_RBUTTON</code></td>\n<td style=\"text-align:left\">右键被按下</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_FLAG_MBUTTON</code></td>\n<td style=\"text-align:left\">中键被按下</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_FLAG_CTRLKEY</code></td>\n<td style=\"text-align:left\"><code>Ctrl</code> 键被按下</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_FLAG_SHIFTKEY</code></td>\n<td style=\"text-align:left\"><code>Shift</code> 键被按下</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><code>EVENT_FLAG_ALTKEY</code></td>\n<td style=\"text-align:left\"><code>Alt</code> 键被按下</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-设置回调函数\"><a class=\"anchor\" href=\"#2-设置回调函数\">#</a> 2. 设置回调函数</h3>\n<p>通过 <code>cv::setMouseCallback</code> 函数为指定窗口注册一个回调函数。当该窗口发生鼠标事件时，注册的函数将被自动调用。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 注册鼠标事件回调函数</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 第一个参数是窗口名称</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 第二个参数是回调函数的指针</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 第三个参数是传递给回调函数的用户自定义数据指针(void*)，默认为0</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">setMouseCallback</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> on_mouse</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> &#x26;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">image</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span></code></pre>\n<h3 id=\"3-回调函数实现\"><a class=\"anchor\" href=\"#3-回调函数实现\">#</a> 3. 回调函数实现</h3>\n<p>下面是一个回调函数的示例，它实现在图像上响应鼠标拖拽并画出红色的线条。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">/**</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> * </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">@brief</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> 鼠标事件回调函数，event和flags共同决定了鼠标具体是什么操作。</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> * </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">@param</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> event</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> 鼠标事件类型 (如 EVENT_LBUTTONDOWN)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> * </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">@param</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> 鼠标在窗口中的x坐标</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> * </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">@param</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> 鼠标在窗口中的y坐标</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> * </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">@param</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> flags</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> 鼠标事件标志 (如 EVENT_FLAG_CTRLKEY)</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> * </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">@param</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> userdata</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> 用户自定义数据指针</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> */</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">void</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> on_mouse</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> event</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> x</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> y</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> int</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\"> flags</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> void</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> *</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">userdata</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    using</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> namespace</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    static</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> Point per_point</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">    static</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> Point cur_point</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 将void*类型的userdata转换为cv::Mat类型的引用</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    Mat</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> img </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> *static_cast</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">*</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">userdata</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">event </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">==</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> EVENT_LBUTTONDOWN</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 左键被按下</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        per_point </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> y</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 记录按下时的坐标</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> else</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\"> if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">event </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">==</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> EVENT_MOUSEMOVE </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x26;&#x26;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> flags </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">==</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> EVENT_FLAG_LBUTTON</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 鼠标移动且左键被按下（拖拽）</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        cur_point </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">x</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> y</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 在图像上画线</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // Scalar(0, 0, 255) 代表 BGR 红色; thickness 表示线的粗细</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        line</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">img</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> per_point</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cur_point</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> Scalar</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 255</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 4</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 刷新显示</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        imshow</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">windows_name</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> img</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 更新上一个点的位置为当前点</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        per_point </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> cur_point</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n<h2 id=\"二-键盘事件的响应\"><a class=\"anchor\" href=\"#二-键盘事件的响应\">#</a> 二、键盘事件的响应</h2>\n<p>键盘事件主要通过 <code>cv::waitKey()</code> 函数捕获。该函数在指定的毫秒数内等待按键事件。</p>\n<ul>\n<li><strong><code>cv::waitKey(delay)</code></strong>:\n<ul>\n<li><code>delay &gt; 0</code>: 等待 <code>delay</code> 毫秒。如果在等待期间有按键按下，函数返回该按键的ASCII码，否则返回 -1。</li>\n<li><code>delay &lt;= 0</code>: 无限期等待，直到有按键按下，然后返回按键的ASCII码。</li>\n</ul>\n</li>\n</ul>\n<p>下面的代码实现了播放视频的功能，当按下 <code>ESC</code> 键时视频暂停（循环结束），再按任意键则程序终止。</p>\n<pre class=\"shiki shiki-themes vitesse-light vitesse-dark\" style=\"background-color:#ffffff;--shiki-dark-bg:#121212;color:#393a34;--shiki-dark:#dbd7caee\" tabindex=\"0\"><code class=\"language-cpp\"><span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">iostream</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">#</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">include</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> &#x3C;</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">opencv2/opencv.hpp</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">></span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">// 假设视频路径已定义</span></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">const</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">string video_path </span><span style=\"color:#999999;--shiki-dark:#666666\">=</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">your_video_file.mp4</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#AB5959;--shiki-dark:#CB7676\">int</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> main</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">(</span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">VideoCapture </span><span style=\"color:#59873A;--shiki-dark:#80A665\">cap</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">video_path</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">!</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">cap</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">isOpened</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">cerr </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\"> \"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">Error: Could not open video file.</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">&#x3C;</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> std</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">endl</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        return</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> -</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">1</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">namedWindow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">show video</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#59873A;--shiki-dark:#80A665\"> cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">WINDOW_NORMAL</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">resizeWindow</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">show video</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 800</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 600</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">    </span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">Mat frame</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 视频帧</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    while</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#1E754F;--shiki-dark:#4D9375\">true</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#123;</span></span>\n<span class=\"line\"><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\">        cap </span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#AB5959;--shiki-dark:#CB7676\">></span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> frame</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B07D48;--shiki-dark:#BD976A\">frame</span><span style=\"color:#999999;--shiki-dark:#666666\">.</span><span style=\"color:#59873A;--shiki-dark:#80A665\">empty</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 如果视频播放完毕，退出循环</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            break</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">        imshow</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#B56959;--shiki-dark:#C98A7D\">show video</span><span style=\"color:#B5695977;--shiki-dark:#C98A7D77\">\"</span><span style=\"color:#999999;--shiki-dark:#666666\">,</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> frame</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 等待16ms，如果期间有按键，则捕获其ASCII码</span></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">        // 27 是 ESC 键对应的ASCII码</span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">        if</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">(</span><span style=\"color:#59873A;--shiki-dark:#80A665\">cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">16</span><span style=\"color:#a13865;--shiki-dark:#d9739f\">)</span><span style=\"color:#AB5959;--shiki-dark:#CB7676\"> ==</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 27</span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">)</span><span style=\"color:#999999;--shiki-dark:#666666\"> </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#123;</span><span style=\"color:#393A34;--shiki-dark:#DBD7CAEE\"> </span></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">            break</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\"> // 如果按下ESC键，退出循环，视频暂停</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">        </span><span style=\"color:#a65e2b;--shiki-dark:#d4976c\">&#125;</span></span>\n<span class=\"line\"><span style=\"color:#999999;--shiki-dark:#666666\">    </span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#A0ADA0;--shiki-dark:#758575DD\">    // 循环结束后，无限期等待下一次按键，然后程序结束</span></span>\n<span class=\"line\"><span style=\"color:#59873A;--shiki-dark:#80A665\">    cv</span><span style=\"color:#999999;--shiki-dark:#666666\">::</span><span style=\"color:#59873A;--shiki-dark:#80A665\">waitKey</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">(</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\">0</span><span style=\"color:#1e754f;--shiki-dark:#4d9375\">)</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#1E754F;--shiki-dark:#4D9375\">    return</span><span style=\"color:#2F798A;--shiki-dark:#4C9A91\"> 0</span><span style=\"color:#999999;--shiki-dark:#666666\">;</span></span>\n<span class=\"line\"><span style=\"color:#2993a3;--shiki-dark:#5eaab5\">&#125;</span></span></code></pre>\n",
            "tags": [
                "OpenCV"
            ]
        }
    ]
}